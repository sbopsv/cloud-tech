<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta property="twitter:card" content="summary_large_image"/><link rel="shortcut icon" type="image/svg" href="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/src/components/images/favicon.png"/><noscript></noscript><meta data-react-helmet="true" property="twitter:description" content="Apache Spark on k8sからHologresへデータ連携方法"/><meta data-react-helmet="true" property="twitter:title" content="Apache Spark on k8sからHologresへデータ連携方法"/><meta data-react-helmet="true" property="og:description" content="Apache Spark on k8sからHologresへデータ連携方法"/><meta data-react-helmet="true" property="og:title" content="Apache Spark on k8sからHologresへデータ連携方法"/><meta data-react-helmet="true" name="description" content="Apache Spark on k8sからHologresへデータ連携方法"/><meta data-react-helmet="true" name="title" content="Apache Spark on k8sからHologresへデータ連携方法"/><meta name="generator" content="Gatsby 4.7.1"/><style data-href="/cloud-tech/styles.8856555286ab9a345435.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css?family=Poppins:400,500&display=swap);@import url(https://fonts.googleapis.com/css2?family=Darker+Grotesque:wght@300;400;500;600;700;800&display=swap);*{box-sizing:border-box;font-display:swap;margin:0;padding:0}::-webkit-input-placeholder{color:#c2c2c2}:-ms-input-placeholder{color:#c2c2c2}::placeholder{color:#c2c2c2}body,html{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Roboto Light,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px}a{color:#639;transition:color .15s}body{font-family:IBM Plex Sans}.commonSectionWrapper{padding:100px 0}.technicalsite-light-blue-bg-color{background-color:#ebf1f6}.subNavVisibleMobile{display:none}.showMobileView{display:none!important}.posStickey{position:-webkit-sticky;position:sticky;top:0;z-index:1}.blueBtn{align-items:center;background-color:#1599e5;border:1px solid #1599e5;border-radius:4px;color:#fafdff;cursor:pointer;display:flex;font-family:IBM Plex Sans;font-size:14px;font-style:normal;font-weight:600;height:40px;justify-content:center;letter-spacing:.02em;line-height:150%;padding:10px 24px;text-transform:uppercase;transition:all .2s ease-in-out 0s;width:auto}.blueBtn:hover{background-color:#0078bd;border:1px solid #0078bd;color:#fafdff}.video-responsive{padding-bottom:56.2%;position:relative}a,a:hover{text-decoration:none}.displayInline{display:inline-block}.containerWrapper{clear:both;margin:0 auto;max-width:1176px;padding:0 32px}.subNavBarToggle{border:1px solid #fff;border-radius:4px;display:none;height:33px;padding:8px 5px;position:absolute;right:20px;width:36px}.subNavBarToggle .iconBar{background-color:#fff;border-radius:1px;display:block;height:2px;margin:4px auto 0;width:22px}.subNavBarToggle .iconBar:first-child{margin-top:0}.video-responsive iframe{height:100%;position:absolute;width:100%}.diffNewLine{background-color:#f0fff4;color:#22863a}.diffRemoveLine{background-color:#fcc;color:red}.navBarParent{align-items:center;display:flex;float:left;width:100%}.divider{border-right:1px solid hsla(0,0%,100%,.3);height:30px;margin:0 15px}.githubIcon{margin-right:5px;width:15px}.githubSection{align-items:center;color:#000;display:flex;margin-bottom:16px;opacity:.7}.githubSection:hover{opacity:1;text-decoration:none}.navbar-default .navbar-toggle .icon-bar{background-color:#fff!important}.navbar-default .navbar-toggle:focus,.navbar-default .navbar-toggle:hover{background-color:#542683}.formElement{background-color:transparent;border-bottom:1px solid hsla(0,0%,100%,.3);position:relative}.formElement .searchIcon{left:16px;position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.formElement:focus{border:none;outline:none}.formElement svg path{fill:#fff}.cursorPointer{cursor:pointer}.searchIconWrapper{align-items:center;display:flex;padding:0 12px}.subnavWithSearch{display:flex}.headerTitle{align-items:center;color:#616d75!important;display:flex;font-family:IBM Plex Sans;font-size:12px;font-style:normal;font-weight:400;font-weight:300;height:auto;line-height:180%}.headerTitle img{margin:0 4px}.headerTitle a{color:#0079bd!important}.headerTitle a:hover{color:#00315f!important;text-decoration:none}.logoWrapper{padding:21px 0 21px 20px}.logoContent{font-family:Roboto;font-size:28px;font-weight:500;line-height:1.5;margin-left:16px;padding-right:10px}.navBarWrapper{position:relative;z-index:1}.navBarDefault{border:0;border-radius:0;margin-bottom:0;position:relative}.navBarDefault,.navBarHeader{align-items:center;display:flex}.navBarHeader{flex:1 1;min-width:335px}.navBarBrand{align-items:center;display:flex;padding:0}.navBarBrand img{display:inline-block;margin-right:8px;width:16px}.navBarUL li{list-style-type:none;padding:0 12px}.navBarUL{-webkit-overflow-scrolling:touch}.navBarUL li:last-child{padding-right:24px}.tableContent{align-items:center;color:#717780;display:flex;font-family:Poppins;font-size:14px;font-style:normal;font-weight:600;height:54px;letter-spacing:.04em;line-height:140%;text-transform:uppercase;width:100%}.tableContent img{transition:all .3s ease-in-out}.tableContent .rotateImg{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.navBarUL li a{color:#1b2738!important;display:flex;font-family:IBM Plex Sans;font-size:14px!important;font-weight:500;line-height:25px;opacity:1;padding:0}.toolTipPos a{position:relative}.toolTipPos a .toolTip{background-color:#1b2738;border-radius:3px;color:#fff;font-family:IBM Plex Sans;font-size:12px;font-style:normal;font-weight:400;left:50%;letter-spacing:-.084px;line-height:20px;min-width:-webkit-max-content;min-width:max-content;opacity:0;padding:2px 6px;position:absolute;top:-26px;-webkit-transform:translateX(-50%);transform:translateX(-50%);transition:all .3s ease-in-out;visibility:hidden}.toolTipPos a:hover .toolTip{opacity:1;visibility:visible}.navBarNav{align-items:center;display:flex}.navBarUL li a .shareIcon,.navBarUL li a img{height:24px}.mainWrapperCollapse{padding-left:32px!important;padding-right:32px!important}.mainWrapper{color:#1b2738}.mainWrapper>h1[id]:before,.mainWrapper>h2[id]:before,.mainWrapper>h3[id]:before,.mainWrapper>h4[id]:before,.mainWrapper>h5[id]:before,.mainWrapper>h6[id]:before{content:"";display:block;height:72px;margin-top:-72px;visibility:hidden}.navBarUL li a:hover{color:#ff6a00!important}pre{background-color:#f5f7f9; /* !important; */border:0!important;white-space:pre-wrap}blockquote{border-left:4px solid;border-color:#e6ecf1;color:#74818d;margin:0 0 24px;padding:0 0 0 12px}.mainWrapper ol,.mainWrapper ul{-webkit-padding-start:40px;-moz-padding-start:40px;-o-padding-start:40px;margin:24px 0;padding:0 0 0 2em}.mainWrapper ol li,.mainWrapper ul li{color:#1b2738;font-size:16px;font-weight:400;font-weight:300;line-height:1.8;padding:8px 0}.mainWrapper ol li a,.mainWrapper ul li a,.paragraph a,b a{color:#0079bd}.mainWrapper ol li a:hover,.mainWrapper ul li a:hover,.paragraph a:hover,b a:hover{color:#005c8f}.headerNav{color:#744cbc;font-family:Roboto;font-size:16px;font-weight:500;line-height:1em;padding:0 24px}.headerNav a{color:#744cbc}.headerNav a,.headerNav a:hover{text-decoration:none}.logoWrapper img{width:40px}.sideBarUL{align-self:flex-start;max-height:calc(100vh - 130px);overflow:auto}.sideBarULHeight{max-height:calc(100vh - 164px)}.sideBarUL .titleNav,.sideBarUL .titleNav a{align-items:center;display:flex;width:100%}.sideBarUL .titleNav a{padding-left:8px}.sideBarUL .titleNav a,.sideBarUL .titleNav:hover{background-color:#ebf1f7}.sideBarUL .titleNav svg{margin-right:8px}.sideBarUL li{list-style-type:none;width:auto}.sideBarUL li a{border:1px solid transparent;border-right:0;color:#1b2738;font-size:14px;font-weight:500;line-height:1.5;padding:7px 25px 7px 15px}.rightSideTitle{color:#1b2738;font-family:IBM Plex Sans;font-size:12px;font-style:normal;font-weight:600;letter-spacing:.02em;line-height:150%;padding:8px 0;text-transform:uppercase}.rightSideBarUL{align-self:flex-start;height:calc(100vh - 170px);max-height:calc(100vh - 170px);overflow:auto;padding-bottom:16px}.rightSideBarUL li{list-style-type:none;padding:8px 24px}.rightSideBarUL li a{color:#74818a;font-family:IBM Plex Sans;font-size:14px;font-style:normal;font-weight:300;line-height:1.5;padding:0}.rightSideBarUL li a:hover{color:#1b2738}.hideFrontLine .collapser{align-items:center;background:transparent;border:none;cursor:pointer;display:flex;height:16px;justify-content:center;margin-right:8px;outline:none;width:16px}.hideFrontLine .greyCircle{background-color:#d5dee6;border-radius:50%;height:4px;margin-right:14px;width:4px}.firstLevel ul li .collapser svg path{fill:#1b2738!important}.active .collapser>svg>path{fill:#639!important}.firstLevel ul .item ul .item{border-left:1px solid #d5dee6}.firstLevel ul .item ul .item a .greyCircle{display:none}.firstLevel ul .item ul .active{border-left:1px solid #1b2738}.sideBarUL .item{list-style:none;padding:0}.sideBarUL .item>a{align-items:center;border-radius:4px;color:#1b2738;display:flex;font-weight:300;padding-left:15px;padding-right:35px;position:relative;text-decoration:none;width:100%}.sideBarNewsletterWrapper{align-self:flex-end;background-color:#f4f8fb;border-top:1px solid #d6dee6;margin-bottom:30px;padding:16px 24px 0;position:relative}.sideBarNewsletterWrapper .closeBtn{align-items:center;background-color:#ebf1f7;border-radius:50%;display:flex;height:25px;justify-content:center;position:absolute;right:10px;top:10px;width:25px}.sideBarNewsletterWrapper .closeBtn svg{transition:all .3s ease-in-out}.rotateImg{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.sideBarNewsletterWrapper .desc{padding-right:16px}.desc{font-weight:300;padding-bottom:12px}.font_600{font-weight:600}.hideFrontLine .active>a{background-color:#ebf1f7;color:#1b2738;font-weight:600}.sideBarUL .item>a:hover{background-color:#ebf1f6}.showFrontLine .item>a:hover{background-color:#542683}.showFrontLine .active>a{background-color:#473485;color:#fff}.sideBarUL .item .item{margin-left:16px}.firstLevel>ul>.item{margin-left:0!important}.showFrontLine .item .item{border-left:1px solid #e6ecf1;padding:0;width:calc(100% - 16px)!important}.showFrontLine .item .active>a{background-color:#542683;border-color:#e6ecf1!important;border-style:solid none solid solid;border-width:1px 0 1px 1px;color:#fff}.titlelistSection{padding:10px 0}.titlelistName,.titlelistSection{align-items:center;display:flex;width:100%}.titlelistImg img{height:120px;max-height:120px;max-width:200px;min-height:120px;min-width:200px;width:200px}.titlelist{font-size:22px;font-weight:700;padding-top:5px}.titlelistDetails{padding-left:20px;width:100%}.titlelistDesc{font-size:18px;padding-top:5px;width:100%}.titlelistAuthor,.titlelistDate{font-size:16px;padding-top:5px;width:100%}.titlelistName img{display:inline-block;margin-left:10px;width:20px}.titlelistName img:hover{opacity:.7}.titleWrapper{align-items:center;display:flex;margin-bottom:8px}.title{flex:1 1;font-size:32px;font-weight:500;line-height:1.5;margin-top:0;padding-top:0}.gitBtn{align-items:center;display:flex;height:30px;min-height:30px}.gitBtn img{display:inline-block;margin-right:5px;width:15px}.addPaddTopBottom{padding:50px 0}.nextPreviousWrapper{-webkit-column-gap:24px;column-gap:24px;display:grid;grid-template-columns:calc(50% - 8px) calc(50% - 8px);grid-template-rows:auto;margin:0;padding:0;width:auto}.previousBtn{-moz-box-align:center;background-color:#fff;border-radius:4px;box-shadow:0 2px 6px rgba(0,0,0,.2);color:#242a31;cursor:pointer;flex-direction:row;padding:0;place-self:stretch;position:relative;text-decoration:none}.leftArrow,.previousBtn{align-items:center;display:flex;margin:0;transition:all .2s ease 0s}.leftArrow{color:#ff6a00;flex:0 0 auto;font-size:24px;padding:16px}.preRightWrapper{display:block;flex:1 1;margin:0;padding:16px;text-align:right}.smallContent{color:#6e6e6e;display:block;margin:0;padding:0}.smallContent span{font-size:12px;font-weight:400;line-height:1.625}.nextPreviousTitle{display:block;margin:0;padding:0;transition:color .2s ease 0s}.nextPreviousTitle span{color:#1b2738;font-size:16px;font-weight:300;line-height:1.5}.nextBtn{-moz-box-align:center;background-color:#fff;border-radius:4px;box-shadow:0 2px 6px rgba(0,0,0,.2);color:#242a31;cursor:pointer;flex-direction:row;padding:0;place-self:stretch;position:relative;text-decoration:none;transition:all .2s ease 0s}.nextBtn,.rightArrow{align-items:center;display:flex;margin:0}.rightArrow{color:#ff6a00;flex:0 0 auto;font-size:24px;padding:16px;transition:color .2s ease 0s;transition:all .2s ease 0s}.nextRightWrapper{display:block;flex:1 1;margin:0;padding:16px}.nextBtn:hover,.previousBtn:hover{background-color:#f8fcff;text-decoration:none}.nextBtn:hover .rightArrow{-webkit-transform:translateX(5px);transform:translateX(5px)}.previousBtn:hover .leftArrow{-webkit-transform:translateX(-5px);transform:translateX(-5px)}table{margin-bottom:36px;padding:0;width:100%}table tr{background-color:#fff;border-top:1px solid #ccc;margin:0;padding:0}table tr:nth-child(2n){background-color:#f8f8f8}table tr th{font-weight:600}table tr td,table tr th{border:1px solid #ccc;margin:0;padding:6px 13px;text-align:left}table tr td :first-child,table tr th :first-child{margin-top:0}table tr td :last-child,table tr th :last-child{margin-bottom:0}img{max-width:100%}.githubBtn{font-size:16px;max-height:40px;padding:10px 0 10px 15px}.githubBtn,.githubBtn span span{align-items:center;display:flex}.communitySection{font-size:24px;font-weight:700}.indexImgSection{padding:0;width:100%}.authorSection{display:flex;padding:20px 0;width:100%}.authorName,.authorSection{align-items:center;display:flex}.authorImg img{border-radius:50%;height:150px;max-height:150px;max-width:150px;min-height:150px;min-width:150px;width:150px}.author{font-size:20px;font-weight:700;padding-top:5px}.authorDetails{padding-left:20px}.authorDesc{font-size:16px;padding-top:5px}.authorName img{display:inline-block;margin-left:10px;width:20px}.authorName img:hover{opacity:.7}.heading1,.heading2,.heading3,.heading4,.heading5,.heading6{color:#1b2738;font-weight:500}.heading1{font-size:26px}.heading1,.heading2{line-height:1.5;margin-bottom:8px}.heading2{font-size:24px}.heading3{font-size:20px}.heading3,.heading4{line-height:1.5;margin-bottom:8px}.heading4{font-size:18px;font-weight:500}.heading5{font-size:16px}.heading5,.heading6{line-height:1.5;margin-bottom:8px}.heading6{font-size:14px}.paragraph{color:#1b2738;font-size:16px;font-weight:300;line-height:1.625;margin-bottom:36px}strong{font-weight:600}.pre{font-size:14px;margin:0 0 32px;overflow:auto;padding:0}.pre pre{border-radius:4px;margin:0;padding:16px}.fontBold{clear:both;float:left;margin-bottom:32px;width:100%}.mainWrapper code{background:#f9f7fb;border:1px solid #ede7f3;border-radius:4px;font-size:.9375em;padding:2px 6px;word-break:break-word}.poweredBy{font-size:.6em;padding:0;text-align:end}.topsubnav{-webkit-transition:top .5s,bottom .5s}@media (max-width:767px){.showMobileView{display:block}.mobileBreadCrumb,.tableContent{display:flex!important}.subResponsive{border-top:1px solid #fff;padding-bottom:20px}.headerTitle{display:block;font-size:12px;margin-left:8px}.headerTitle img{position:relative;top:4px}.navBarBrand{margin-top:4px;min-height:auto}.navBarBrand img{margin-right:8px}.subNavVisibleMobile{background-color:#f9fcff;border-top:1px solid #d5dee5;box-shadow:0 2px 4px rgba(0,0,0,.06);left:50%;margin-left:-50vw;padding:0 32px 24px;position:relative;width:100vw}.topsubnav.subResponsive .subNavVisibleMobile{display:block;height:calc(100vh - 50px);overflow:auto}.topsubnav .navBarUL{display:none}.topsubnav.subResponsive .navBarUL{display:block;text-align:left}.hiddenMobile{display:none!important}hr{margin-bottom:0;margin-top:0}.navBarParent{display:block}.separator{margin-bottom:20px;margin-top:20px}.navBarULRight{position:static}.navBarUL{align-items:center;display:flex;margin:7.5px 0}.navBarUL li{height:37px}.navBarUL li a{font-size:14px;padding:10px 15px}.navBarDefault{display:block;z-index:0}.subNavBarToggle{display:block;margin-right:0}.navBarHeader{align-items:flex-start;background-color:#fff;display:flex;min-width:auto;padding-right:0}.navBarBrand{flex:initial;font-size:20px;padding:0}.titleWrapper{display:block}.title{font-size:28px}.mainWrapper{word-break:break-word}.nextPreviousWrapper{display:block;padding:0 15px}.previousBtn{margin-bottom:20px}.mobileView{padding-left:0!important;text-align:left!important}.hitWrapper{max-height:-webkit-fit-content;max-height:-moz-fit-content;max-height:fit-content;position:static;right:0;top:35px;width:100%}.authorSection{width:100%}}@media (min-width:768px) and (max-width:991px){.navBarDefault{padding:10px}.navBarBrand{font-size:22px}.navBarHeader{min-width:240px}.githubBtn{padding:10px}.divider{height:20px;margin:0 5px}.hitWrapper{max-width:500px}.navBarUL li a{padding:10px 5px}.authorSection{width:100%}}@media (max-width:1049px){.viewport{overflow-x:hidden}}@font-face{font-display:swap;font-family:Poppins;src:url(/fonts/poppins-regular-latin.woff2) format("woff2")}@font-face{font-display:swap;font-family:Poppins;font-weight:600;src:url(/fonts/poppins-600-latin.woff2) format("woff2")}@font-face{font-display:swap;font-family:Poppins;font-weight:700;src:url(/fonts/poppins-bold-latin.woff2) format("woff2")}@font-face{font-display:swap;font-family:Darker Grotesque;font-weight:300;src:url(/fonts/darker-grotesque-300.woff2) format("woff2")}@font-face{font-display:swap;font-family:Darker Grotesque;font-weight:400;src:url(/fonts/darker-grotesque-regular.woff2) format("woff2")}@font-face{font-display:swap;font-family:Darker Grotesque;font-weight:500;src:url(/fonts/darker-grotesque-500.woff2) format("woff2")}@font-face{font-display:swap;font-family:Darker Grotesque;font-weight:600;src:url(/fonts/darker-grotesque-600.woff2) format("woff2")}@font-face{font-display:swap;font-family:Darker Grotesque;font-weight:700;src:url(/fonts/darker-grotesque-600.woff2) format("woff2")}@font-face{font-display:swap;font-family:Darker Grotesque;font-weight:700;src:url(/fonts/darker-grotesque-bold.woff2) format("woff2")}@font-face{font-display:swap;font-family:Darker Grotesque;font-weight:800;src:url(/fonts/darker-grotesque-extra-bold.woff2) format("woff2")}@font-face{font-display:swap;font-family:Darker Grotesque;font-weight:900;src:url(/fonts/darker-grotesque-black.woff2) format("woff2")}@font-face{font-display:swap;font-family:IBM Plex Sans;font-weight:200;src:url(/fonts/IBM-Plex-Sans-200.woff2) format("woff2")}@font-face{font-display:swap;font-family:IBM Plex Sans;font-weight:300;src:url(/fonts/IBM-Plex-Sans-300.woff2) format("woff2")}@font-face{font-display:swap;font-family:IBM Plex Sans;font-weight:500;src:url(/fonts/IBM-Plex-Sans-500.woff2) format("woff2")}@font-face{font-display:swap;font-family:IBM Plex Sans;font-weight:600;src:url(/fonts/IBM-Plex-Sans-600.woff2) format("woff2")}@font-face{font-display:swap;font-family:IBM Plex Mono;font-weight:600;src:url(/fonts/IBM-Plex-Mono-600.woff2) format("woff2")}.technicalsite-ibm-plex-btn{font-size:14px;line-height:150%}.technicalsite-font-thin{font-weight:300!important}.technicalsite-font-normal{font-weight:400!important}.technicalsite-font-500{font-weight:500!important}.technicalsite-font-600{font-weight:600!important}.technicalsite-font-bold,.technicalsite-font-extra-700{font-weight:700!important}.technicalsite-font-extra-bold{font-weight:800!important}.technicalsite-font-black{font-weight:900!important}.box-shadow-header{box-shadow:0 2px 6px 0 rgba(0,0,0,.2)}.gitHubBtnMobile{display:none}.m-top-10{margin-top:10px}.p-top-10{padding-top:10px}.learnHeader{clear:both;margin:0 auto;padding:0 32px}.m-top-15{margin-top:15px}.m-b-5{margin-bottom:5px}.m-b-10{margin-bottom:14px}.DarkModeHeader,.lightModeHeader{height:72px;padding-top:0;transition:top .3s;z-index:100000!important}.positionStickyHeader{position:-webkit-sticky;position:sticky;top:0}.hideNavHeader{top:-72px}.mainHeader{-webkit-transform:translateY(0);transform:translateY(0);transition:all .3s ease-in-out}.hideMainHeader{-webkit-transform:translateY(-102px);transform:translateY(-102px)}.lightModeHeader{background:#fff}.DarkModeHeader{background-color:#1b2738}.visibleMobile{background:#fff!important;display:block;height:calc(100vh - 80px);overflow:auto;position:relative;transition:all .3s ease-out;width:100%}.hideMobile{display:block}#menuClick{cursor:pointer;margin-right:32px;-webkit-transform:rotate(0deg);transform:rotate(0deg);transition:.5s ease-in-out;width:20px}#menuClick span:first-child{top:0}#menuClick span:first-child,#menuClick span:nth-child(2){-webkit-transform-origin:left center;transform-origin:left center}#menuClick span:nth-child(2){top:18px}#menuClick span:nth-child(3){top:36px;-webkit-transform-origin:left center;transform-origin:left center}#menuClick.open span:first-child{left:8px;top:-3px;-webkit-transform:rotate(45deg);transform:rotate(45deg)}#menuClick.open span:nth-child(2){opacity:0;width:0}#menuClick.open span:nth-child(3){left:8px;top:39px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.navBarToggle{border-radius:4px;display:none;padding:0;position:absolute;right:0;top:30px}.navBarToggle .iconBar{border-radius:1px;display:block;height:3px;margin:4px auto 0;transition:all .3s ease-in-out;width:20px}.navBarToggle .iconBar:first-child{margin-top:0}.navBarToggle:focus{outline:none}.dropDownList:hover .dropDownContent{opacity:1;visibility:visible}.dropDownList:hover .dropdown-link-btn{color:#0079bd!important}.dropDownList .dropDownContent{display:flex;left:0;opacity:0;position:absolute;top:50px;transition:all .3s ease-in-out;visibility:hidden}.lightModeHeader .navBarToggleBg .navBarToggle .iconBar{background-color:#00315f}.lightModeHeader .headerWrapper .navBarUL li{font-family:IBM Plex Sans!important}.lightModeHeader .headerWrapper .navBarUL li a{color:#1b2738}.lightModeHeader .headerWrapper .navBarUL .navListActive a,.lightModeHeader .headerWrapper .navBarUL li a:hover{color:#0079bd}.lightModeHeader .headerWrapper .navBarUL .navLogIn a{color:#0079bd!important}.lightModeHeader .headerWrapper .navBarUL .navLogIn a:hover{color:#0b5599!important}.DarkModeHeader .navBarToggleBg .navBarToggle .iconBar,.DarkModeHeader .navBarToggleBg .navBarToggle.open .iconBar{background-color:#f2f2f2}.DarkModeHeader .headerWrapper .navBarUL li a{color:#f2f2f2}.DarkModeHeader .headerWrapper .navBarUL .navListActive a,.DarkModeHeader .headerWrapper .navBarUL li a:hover{color:#0079bd}.DarkModeHeader .headerWrapper .navBarUL .navLogIn a{color:#f2f2f2}.headerWrapper{align-items:center;border-bottom:0!important;display:flex;height:72px;position:relative;z-index:10}.headerWrapper .m-nav-t{margin-top:13px}.headerWrapper .navBarUL{align-items:center;display:flex!important;height:100%;padding-left:23px}.headerWrapper .navBarUL #search-alt-icon{margin-right:1.4px;margin-top:-2.3px}.headerWrapper .navBarUL .search-icon{cursor:pointer;padding-right:32px}.headerWrapper .navBarUL .search-icon-learn{align-items:center;border:1px solid #bfcad3;border-radius:4px;cursor:pointer;display:flex!important;flex:1 1;height:40px;justify-content:space-between;padding-right:32px;padding:0 8px!important}.headerWrapper .navBarUL .search-icon-learn .squareBox{align-items:center;border:1px solid #bfcad3;border-radius:2px;display:flex;height:20px;justify-content:center;margin-right:8px;padding:4px;width:20px}.headerWrapper .navBarUL .search-icon-learn span{align-items:center;color:#909da6;display:flex}.headerWrapper .navBarUL .search-icon-learn span svg{margin-right:6px}.headerWrapper .navBarUL li{display:inline-block;font-family:IBM Plex Sans;font-size:14px;font-weight:500;line-height:25px;padding:0 40px 0 0}.headerWrapper .navBarUL li:last-child{padding-right:0!important}.headerWrapper .navBarUL li:first-child{padding-right:30px!important}.headerWrapper .navBarUL li a{position:relative}.headerWrapper .navBarUL li a:hover{text-decoration:none}.headerWrapper .navBarUL li a:focus{outline:none;text-decoration:none}.headerWrapper .navBarUL .github-btn-header{margin-top:5px;min-width:125px}.headerWrapper .navLeft .brand a{display:flex}.headerWrapper .navLeft .brand img{width:275px}.headerWrapper .navLeftBgColor{background-color:#ebf1f6}.headerWrapper .navRight{align-items:center;display:flex;flex:1 1;height:72px}.headerWrapper .navRight .technicalsite-blue-btn{background:#1699e2;border:none;border-radius:4px;color:#f4fbff;cursor:pointer;font-family:IBM Plex Sans!important;font-size:14px!important;font-weight:500!important;height:43px!important;transition:all .2s ease-in-out;white-space:nowrap;width:106px!important}.headerWrapper .navRight .technicalsite-blue-btn:hover{background:#0079bd}.headerWrapper .navRight .navBarUL{flex:1 1;padding-left:40px}.headerWrapper .navRight .navBarUL li{padding-left:32px;padding-right:0!important}.containerWidth{padding:0 15px;width:100%}@media(min-width:1050px){.visibleMobile{display:none}.containerWidth{margin:0 auto;padding:0;width:1045px!important}}@media(min-width:1050px)and (max-width:1325px){.learnHeader{padding:0 16px}.headerWrapper .navBarUL{padding-left:16px}.headerWrapper .navBarUL li{padding:0 16px 0 0}.headerWrapper .navBarUL li:first-child{padding-right:16px!important}.headerWrapper .navBarUL .search-icon{min-width:200px}.headerWrapper .navRight .navBarUL li{padding-left:16px}}@media(min-width:1388px){.containerWidth{margin:0 auto;padding:0;width:1328px!important}}@media(max-width:1049px){.visibleMobile{right:-1050px}.stickyOnMobile{position:-webkit-sticky;position:sticky}.navBarToggle{display:block;z-index:100}.search-icon{right:30px}.DarkModeHeader,.lightModeHeader{border-bottom:1px solid #d5dee5;box-shadow:none;padding-top:0}.gitHubBtnMobile{display:block;position:absolute;right:40px;top:28px}.gitHubBtnMobile .technicalsite-gray-btn{padding:4px 10px}.hideMobile{display:none!important}.headerWrapper{align-items:center;display:flex;height:80px!important;width:100%}.headerWrapper .navLeft{z-index:100}.headerWrapper .navLeft .brand{margin-right:12px!important}.headerWrapper .topnav .visibleMobile{background-color:#fff;border-radius:8px}.headerWrapper .topnav .visibleMobile .brand{background-color:#fff;border-bottom:1px solid #d5dee5;padding-bottom:20px;padding-left:24px;padding-top:23px;position:-webkit-sticky;position:sticky;top:0;z-index:100}.headerWrapper .topnav .visibleMobile .brand img{width:116px}.mobileNavListWrapper{display:flex;flex-direction:column;height:auto;justify-content:space-between;min-height:100%}.mobileNavListWrapper .mobile-github-btn-div{align-items:center;border-left:1px solid #d5dee5;display:flex;height:64px;justify-content:center;padding-left:26px;text-align:center;width:50%}.mobileNavListWrapper #mobile-header-cta{padding-bottom:80px}.mobileNavListWrapper .technicalsite-light-gray-btn{background:#fff!important;border:none;border-bottom:1px solid #d5dee5;font-family:IBM Plex Sans!important;font-size:14px;height:64px!important;line-height:150%;padding:8px 32px;width:100%}.mobileNavListWrapper .m-get-started{margin-bottom:40px;margin-top:32px;padding:0 32px;width:100%}.mobileNavListWrapper .m-get-started button{background:#1699e2;border:none;border-radius:4px;color:#f4fbff;cursor:pointer;font-family:IBM Plex Sans!important;font-size:14px!important;font-weight:500!important;height:auto;height:43px!important;justify-content:center;min-height:43px;text-align:center!important;transition:all .2s ease-in-out;white-space:nowrap;width:100%}.mobileNavListWrapper .m-get-started button:hover{background:#0079bd}.mobileNavListWrapper .technicalsite-btn{align-items:center;box-shadow:none!important;display:flex;justify-content:space-between;text-align:left!important;text-transform:capitalize!important}.mobileNavListWrapper .grey-border{border-bottom:1px solid #d5dee5}.mobileNavListWrapper .rotate-down{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.mobileNavButtonWrapper{background:#dfe7ee;border-radius:8px;border-top:1px solid #d5dee5;padding:24px}.mobileNavButtonWrapper .technicalsite-btn-sm{display:inline-block;padding:4px 16px;width:49%}.mobileNavButtonWrapper .technicalsite-green-btn{margin-right:2%}.menuBarView{height:calc(100vh - 123px);overflow:auto}.navBarToggle{display:block!important}.topnav.responsive .visibleMobile{right:16px}.navBarUL{display:none}}@media(max-width:379px){.gitHubBtnMobile{display:none!important}.headerWrapper .topnav .visibleMobile .mobileNavButtonWrapper{display:block}.headerWrapper .topnav .visibleMobile .mobileNavButtonWrapper .technicalsite-btn-sm{margin:4px 0;width:100%}}@media(max-width:767px){header{border-bottom:1px solid #d5dee5;height:80px!important;min-height:80px}.topnav.responsive .visibleMobile{right:0}.search-icon{margin-top:-2px!important}.search-icon svg{height:36px;min-width:36px}}@media(max-width:500px){.headerWrapper .topnav .visibleMobile{width:100%!important}.visibleMobile{right:-500px}.topnav.responsive .visibleMobile{right:0}}.mt-16{margin-top:16px}.floating-subscribe-wrapper{position:relative;width:250px;z-index:1}.floating-subscribe-wrapper .floating-subscribe-close{cursor:pointer;opacity:.8;position:absolute;right:24px;top:24px;width:20px}.floating-subscribe-wrapper .floating-subscribe-close:hover{opacity:1}.floating-subscribe-wrapper .floating-subscribe-close:focus{outline:none}.floating-subscribe-wrapper{background:#fff;border-radius:5px;box-shadow:0 2.75335px 44.0535px rgba(0,0,0,.12);padding:24px;text-align:center}.floating-subscribe-wrapper .icon{padding-bottom:24px;text-align:left}.floating-subscribe-wrapper h2{font-family:Roboto;font-size:20px;font-weight:600;line-height:125%;margin:0;padding-bottom:8px;text-align:left}.floating-subscribe-wrapper .pr-40{padding-right:40px}.floating-subscribe-wrapper .post-subscription-description{color:#001934;font-family:Roboto;font-size:14px;font-weight:400;line-height:20px;padding-bottom:16px;text-align:left}.floating-subscribe-wrapper .buttonWrapper{padding-top:8px}.floating-subscribe-wrapper .subscribeBtn{background-color:rgba(255,106,0,.8);border:0;border-radius:5px;color:#fff;cursor:pointer;font-family:Roboto;font-size:14px;font-weight:600;height:36px;padding:2px 5px;transition:.5s;transition:all .2s ease-in-out;width:auto;width:100%}.floating-subscribe-wrapper .subscribeBtn:focus{outline:none}.floating-subscribe-wrapper .subscribeBtn:hover{background-color:#ff6a00}.floatingShareWrapper,.subscribeIcon{background:#fff;border-radius:8px;bottom:40px;box-shadow:0 4px 64px rgba(0,0,0,.12);display:flex;justify-content:space-around;padding:10px 0;position:fixed;z-index:1}.floatingShareWrapper img,.subscribeIcon img{cursor:pointer;-webkit-filter:grayscale(100%);filter:grayscale(100%);margin:0;width:22px}.floatingShareWrapper img:hover,.subscribeIcon img:hover{-webkit-filter:none;filter:none}.floatingShareWrapper .shareIcon,.subscribeIcon .shareIcon{align-items:center;display:flex;height:23px;position:relative}.floatingShareWrapper .shareIcon .copiedWrapper,.subscribeIcon .shareIcon .copiedWrapper{background-color:#000;border-radius:4px;color:#fff;font-size:14px;left:50%;padding:3px 5px;position:absolute;top:-32px;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.floatingShareWrapper{right:30px;width:250px}.subscribeIcon{right:305px;width:auto}.subscribeIcon img{margin:0 12px}.floatingSubscribeVisible{bottom:100px;opacity:0;position:fixed;right:30px;-webkit-transform:translateY(150px);transform:translateY(150px);transition:all .3s ease-out;visibility:hidden;z-index:100}.floatingTransition{opacity:1;-webkit-transform:translateY(0);transform:translateY(0);transition:-webkit-transform .3s ease-out;transition:transform .3s ease-out;transition:transform .3s ease-out,-webkit-transform .3s ease-out;visibility:visible}@media(max-width:1059px){.mobileShow{display:block}.subscribeIcon{display:none}.mobileFloatingView{padding-bottom:40px;position:relative}.floatingSubscribeVisible{margin-bottom:30px;opacity:1;position:static;-webkit-transform:translateY(0);transform:translateY(0);visibility:visible}.floating-subscribe-wrapper{position:static;width:100%}.floating-subscribe-wrapper .pr-40{padding-right:0}.floatingShareWrapper{border-radius:0;bottom:0;justify-content:space-around;padding:13px 0;right:0;width:100%}}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:100;src:local("Roboto Thin "),local("Roboto-Thin"),url(/cloud-tech/static/roboto-latin-100-c2aa4ab115bf9c6057cb59709d0e152b.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-100-a45108d3b34af91f9113d827a183296d.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:100;src:local("Roboto Thin italic"),local("Roboto-Thinitalic"),url(/cloud-tech/static/roboto-latin-100italic-7f839a8652da29745ce4260846c3f88e.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-100italic-451d4e559d6f57cdf6a1c54a3e32e11d.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:local("Roboto Light "),local("Roboto-Light"),url(/cloud-tech/static/roboto-latin-300-37a7069dc30fc663c8781220e5669d25.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-300-865f928cbabcc9f8f2b50fb47a20bc63.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:300;src:local("Roboto Light italic"),local("Roboto-Lightitalic"),url(/cloud-tech/static/roboto-latin-300italic-c64e7e354c88e613c77cab8ac2ebc3ae.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-300italic-bd5b7a13f2c52b531a2a787bf6eb4a13.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:local("Roboto Regular "),local("Roboto-Regular"),url(/cloud-tech/static/roboto-latin-400-176f8f5bd5f02b3abfcf894955d7e919.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-400-49ae34d4cc6b98c00c69ab4c41de3e0c.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:400;src:local("Roboto Regular italic"),local("Roboto-Regularitalic"),url(/cloud-tech/static/roboto-latin-400italic-d022bc70dc1bf7b3425da9cdaa9841b6.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-400italic-b1d9d9904bfca8802a631c45590b9efa.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:local("Roboto Medium "),local("Roboto-Medium"),url(/cloud-tech/static/roboto-latin-500-f5b74d7ffcdf85b9dd60130fa0b2c087.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-500-cea99d3e3e13a3a599a015c29f1046d0.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:500;src:local("Roboto Medium italic"),local("Roboto-Mediumitalic"),url(/cloud-tech/static/roboto-latin-500italic-0d8bb5b3ee5f5dac9e446d48480d28a9.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-500italic-18d00f739ff1e1c52db1a1c0d9e98129.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:700;src:local("Roboto Bold "),local("Roboto-Bold"),url(/cloud-tech/static/roboto-latin-700-c18ee39fb002ad58b6dc595476f88fef.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-700-2267169ee7270a22a963b2b2bfb7ab0c.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:700;src:local("Roboto Bold italic"),local("Roboto-Bolditalic"),url(/cloud-tech/static/roboto-latin-700italic-7d8125ff7f707231fd89d9d7109deadf.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-700italic-9360531f9bb817f917f01a6d394515f3.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:900;src:local("Roboto Black "),local("Roboto-Black"),url(/cloud-tech/static/roboto-latin-900-870c8c1486f76054301a22c35403eae1.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-900-bac8362e7a6ea60b6983ecf09a411a5e.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:italic;font-weight:900;src:local("Roboto Black italic"),local("Roboto-Blackitalic"),url(/cloud-tech/static/roboto-latin-900italic-cb5ad999740e9d8a8bd1b03b379293a9.woff2) format("woff2"),url(/cloud-tech/static/roboto-latin-900italic-c20d916c1a1b094c1cec7de61e470633.woff) format("woff")}</style><link rel="sitemap" type="application/xml" href="/cloud-tech/sitemap/sitemap-index.xml"/><title data-react-helmet="true">Apache Spark on k8sからHologresへデータ連携方法</title><link data-react-helmet="true" rel="canonical" href="https://sbopsv.github.io/cloud-tech/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres"/><link crossorigin="" href="https://APGJ5PHUST-dsn.algolia.net" rel="preconnect"/><link rel="alternate" type="application/rss+xml" title="テクニカルサイト" href="/cloud-tech/rss.xml"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-85904527-10"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-85904527-10', {"send_page_view":false});
      }
      </script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'GTM-WLG6JZ3');</script><link as="script" rel="preload" href="/cloud-tech/webpack-runtime-08625babbb4b9af8a274.js"/><link as="script" rel="preload" href="/cloud-tech/framework-3a4afe8555327377c75b.js"/><link as="script" rel="preload" href="/cloud-tech/commons-c34b975b1ab0a98aa302.js"/><link as="script" rel="preload" href="/cloud-tech/app-32a237daea924fa1527a.js"/><link as="fetch" rel="preload" href="/cloud-tech/page-data/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/cloud-tech/page-data/sq/d/2619113677.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/cloud-tech/page-data/sq/d/3706406642.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/cloud-tech/page-data/sq/d/4293085174.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/cloud-tech/page-data/app-data.json" crossorigin="anonymous"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WLG6JZ3" height="0" width="0" style="display: none; visibility: hidden" aria-hidden="true"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="viewport" class="viewport"><header id="header" class="lightModeHeader box-shadow-header positionStickyHeader"><div class="learnHeader"><div class="headerWrapper"><div id="navBrand" class="navLeft"><div class="brand"><a href="https://sbopsv.github.io/cloud-tech"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/src/components/images/TechnicalSite_5.png" alt="TechnicalSite Logo" title="TechnicalSite Logo"/></a></div></div><div class="navRight hideMobile"><ul class="navBarUL"><li class="search-icon-learn"><span><svg class="sc-bdvvtL gHROrR" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L18.2929 19.7843C18.6835 20.1742 19.3162 20.1738 19.7064 19.7836L19.7836 19.7064C20.1738 19.3162 20.1742 18.6835 19.7843 18.2929L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z"></path></svg>Search...</span><div class="squareBox"><svg id="search-alt-icon" width="7" height="12" viewBox="0 0 7 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.5 16.5L5.96718 1.06173" stroke="#909DA6" stroke-width="1.5" stroke-linejoin="round"></path></svg></div></li><li><a href="https://sbopsv.github.io/cloud-tech/rss.xml">RSS</a></li></ul></div></div></div><div id="navbar" class="topnav" style="height:0px"><div class="navBarToggleBg"><div class="navBarToggle search-icon"><svg class="sc-bdvvtL huWgZD" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L18.2929 19.7843C18.6835 20.1742 19.3162 20.1738 19.7064 19.7836L19.7836 19.7064C20.1738 19.3162 20.1742 18.6835 19.7843 18.2929L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z"></path></svg></div></div><div class="visibleMobile"><div class="mobileNavListWrapper"></div></div></div></header><style data-emotion="css znzi2a">.css-znzi2a{display:grid;grid-template-columns:1fr;-webkit-transition:all 0.3s ease-in-out 0s;transition:all 0.3s ease-in-out 0s;padding-left:320px;padding-right:256px;}.css-znzi2a .learnAsideWrapperPos{padding:32px 32px!important;}.css-znzi2a .sidebarWrapperCollapse{background-color:transparent!important;width:150px!important;border-right:0!important;border-bottom:0!important;min-height:auto!important;height:auto!important;}@media(max-width: 1024px){.css-znzi2a{padding-left:0;padding-right:0;}.css-znzi2a .translateXZero{-webkit-transform:translateX(0)!important;-moz-transform:translateX(0)!important;-ms-transform:translateX(0)!important;transform:translateX(0)!important;}}</style><div class=" css-znzi2a et716sf6"><style data-emotion="css ahfd3o">.css-ahfd3o{width:56px;height:56px;border-radius:50%;background-color:#ff6a00;box-shadow:0px 10px 30px rgba(0, 0, 0, 0.16);position:fixed;bottom:24px;right:24px;z-index:1000000!important;display:none;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;}.css-ahfd3o svg{width:24px;height:24px;}.css-ahfd3o svg path{fill:#fff;}@media(max-width: 1024px){.css-ahfd3o{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;box-shadow:0px 10px 30px rgba(0, 0, 0, 0.16);}}</style><div class="css-ahfd3o et716sf0"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 2.25C2.58579 2.25 2.25 2.58579 2.25 3V21C2.25 21.4142 2.58579 21.75 3 21.75H9H21C21.4142 21.75 21.75 21.4142 21.75 21V3C21.75 2.58579 21.4142 2.25 21 2.25H9H3ZM9.75 3.75V20.25H20.25V3.75H9.75ZM8.25 3.75H3.75V20.25H8.25V3.75Z" fill="#ff6a00"></path></svg></div><style data-emotion="css 4vpnib">.css-4vpnib{width:320px;background-color:rgb(244, 248, 251);min-height:calc(100vh - 72px);height:calc(100vh - 72px);border-right:1px solid rgb(214, 222, 230);border-bottom:1px solid rgb(214, 222, 230);display:grid;position:fixed;top:72px;left:0px;-webkit-transition:all 0.3s ease-in-out 0s;transition:all 0.3s ease-in-out 0s;}.css-4vpnib .p16{padding:24px 16px;padding-bottom:0;}.css-4vpnib .mainSideBarToggle{position:absolute;top:26px;left:300px;z-index:100000!important;width:32px;height:32px;border-radius:50%;background-color:#fff;box-shadow:0px 2px 6px rgba(0, 0, 0, 0.2);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;cursor:pointer;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;}.css-4vpnib .mainSideBarToggle svg path{fill:#1B2738;}.css-4vpnib .mainSideBarToggle .navigation{position:absolute;left:42px;top:8px;}.css-4vpnib .alignSelfEnd{-webkit-align-self:flex-end;-ms-flex-item-align:flex-end;align-self:flex-end;}.css-4vpnib .showMobile{display:none;}.css-4vpnib .mainSideBarTogglePos{left:16px;}@media(max-width: 1024px){.css-4vpnib{z-index:100000!important;-webkit-transform:translateX(-340px);-moz-transform:translateX(-340px);-ms-transform:translateX(-340px);transform:translateX(-340px);min-height:calc(100vh - 100px);height:calc(100vh - 100px);top:0;box-shadow:0px 4px 14px rgba(0, 0, 0, 0.16);}.css-4vpnib .mainSideBarToggle{display:none;}.css-4vpnib .showMobile{display:block;}}</style><div class=" css-4vpnib et716sf3"><div class="mainSideBarToggle" role="presentation"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.99988 1.25C1.58566 1.25 1.24988 1.58579 1.24988 2V14C1.24988 14.4142 1.58566 14.75 1.99988 14.75H5.99988C5.99992 14.75 5.99996 14.75 6 14.75H14C14.4142 14.75 14.75 14.4142 14.75 14V2C14.75 1.58579 14.4142 1.25 14 1.25H6C5.99996 1.25 5.99992 1.25 5.99988 1.25H1.99988ZM2.74988 13.25V2.75H5.24988V13.25H2.74988ZM6.75 13.25V2.75H13.25V13.25H6.75Z" fill="#964003"></path></svg></div><div class="p16"><style data-emotion="css 1ly8se">.css-1ly8se{width:100%;padding-left:0px;padding-right:0;display:grid;}@media (min-width: 767px) and (max-width: 1023px){.css-1ly8se{padding-left:0;}}@media only screen and (max-width: 767px){.css-1ly8se{top:0px;padding-left:0px;background-color:#F9FCFF;background:#F9FCFF;height:auto;position:relative;}}</style><aside class="css-1ly8se e13qcebe1"><ul class="sideBarUL"><li class="hideFrontLine firstLevel item "><ul><li class=" item "><a href="/cloud-tech/introduction"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>はじめに</a></li><li class=" item "><a href="/cloud-tech/advisory"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>プロダクト導入アドバイザリ</a></li><li class=" item "><a href="/cloud-tech/product_service"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>プロダクトサービス一覧＆紹介</a></li><li class=" item "><a href="/cloud-tech/migration"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>マイグレーション</a></li><li class=" item "><a href="/cloud-tech/DaaS"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>ソリューション - Cloud Remote Desktop</a></li><li class=" item "><a href="/cloud-tech/WebApplication-tutorial"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>Webアプリ開発チュートリアル</a></li><li class=" item "><a href="/cloud-tech/DataAnalytics-tutorial"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>データ分析チュートリアル</a></li><li class=" item "><a href="/cloud-tech/network-connect-case"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>ネットワーク機器接続パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-serverless"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>サーバレス活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-computing"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>コンピューティング活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-storage"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>ストレージ活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-network"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>ネットワーク活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-Database"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>Database系プロダクトサービス</a></li><li class=" item "><a href="/cloud-tech/usecase-Application"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>ミドルウェア活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-kubernetes"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>kubernetes活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-PolarDB"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>PolarDB活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-LogService"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>LogService活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-MaxCompute"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>MaxCompute活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-Hologres"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>Hologres活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-Elasticsearch"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>Elasticsearch活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-ClickHouse"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>ApsaraDB for ClickHouse活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-DataLakeAnalytics"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>DataLakeAnalytics活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-datav"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>DataV活用パターン</a></li><li class=" item "><a href="/cloud-tech/usecase-security"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>Security系プロダクトサービス</a></li><li class=" item "><a href="/cloud-tech/usecase-media"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>Media系プロダクトサービス</a></li><li class=" item "><a href="/cloud-tech/usecase-iot"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>IoT系プロダクトサービス</a></li><li class=" item "><a href="/cloud-tech/usecase-AI"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>AI系プロダクトサービス</a></li><li class=" item "><a href="/cloud-tech/developer-tools"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>開発者向けツール</a></li><li class=" item "><a href="/cloud-tech/Terraform"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>Terraform</a></li><li class=" item "><a href="/cloud-tech/usecase-3rdParty"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>外部3rdサービス連携パターン</a></li><li class=" item "><a href="/cloud-tech/ICP"><button aria-label="collapse" class="collapser"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.21966 15.1553C5.92677 14.8625 5.92677 14.3876 6.21966 14.0947L11.2578 9.05655L6.21966 4.01841C5.92677 3.72551 5.92677 3.25064 6.21966 2.95775C6.51256 2.66485 6.98743 2.66485 7.28032 2.95775L12.8488 8.52622C13.1417 8.81911 13.1417 9.29398 12.8488 9.58688L7.28032 15.1553C6.98743 15.4482 6.51256 15.4482 6.21966 15.1553Z"></path></svg></button>ICP</a></li></ul></li><style data-emotion="css 1q387v1">.css-1q387v1{list-style:none;padding:0.5rem 0;}.css-1q387v1 hr{margin:0;padding:0;border:0;border-bottom:1px solid #ede7f3;}</style><li class="css-1q387v1 e13qcebe0"><hr/></li><style data-emotion="css f8k5cv">.css-f8k5cv{list-style:none;}.css-f8k5cv a{color:#1B2738;-webkit-text-decoration:none;text-decoration:none;font-weight:400;padding:0.45rem 0 0.45rem 2rem;display:block;position:relative;}.css-f8k5cv a:hover{background-color:#EBF1F6;}.css-f8k5cv a svg{float:right;margin-right:1rem;}</style><li class="css-f8k5cv e13qcebe2"><a href="https://tm.softbank.jp/form/cloud/iaas/index.php?ref=lp-alibaba" to="https://tm.softbank.jp/form/cloud/iaas/index.php?ref=lp-alibaba" target="_blank" rel="noopener noreferrer">お問い合わせ<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li><li class="css-f8k5cv e13qcebe2"><a href="https://www.softbank.jp/biz/services/platform/alibabacloud/" to="https://www.softbank.jp/biz/services/platform/alibabacloud/" target="_blank" rel="noopener noreferrer">ソフトバンクのAlibabaCloudサービス<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li><li class="css-f8k5cv e13qcebe2"><a href="https://www.softbank.jp/biz/services/platform/alibabacloud/about/ps/" to="https://www.softbank.jp/biz/services/platform/alibabacloud/about/ps/" target="_blank" rel="noopener noreferrer">サービス構築はPSへ<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li><li class="css-f8k5cv e13qcebe2"><a href="https://www.softbank.jp/biz/services/platform/alibabacloud/about/msp/" to="https://www.softbank.jp/biz/services/platform/alibabacloud/about/msp/" target="_blank" rel="noopener noreferrer">監視・運用代行はMSPへ<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li><li class="css-f8k5cv e13qcebe2"><a href="https://www.softbank.jp/biz/services/platform/alibabacloud/about/ts/" to="https://www.softbank.jp/biz/services/platform/alibabacloud/about/ts/" target="_blank" rel="noopener noreferrer">よくある質問はTSSへ<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li><li class="css-f8k5cv e13qcebe2"><a href="https://www.alibabacloud.com/" to="https://www.alibabacloud.com/" target="_blank" rel="noopener noreferrer">Alibaba Cloud公式サイト<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></a></li></ul></aside></div></div><style data-emotion="css 10pix7a">.css-10pix7a{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:0px auto;max-width:1176px;width:100%;padding:32px;}</style><main class=" css-10pix7a et716sf5"><style data-emotion="css 1l1xtmm">@media only screen{.css-1l1xtmm{width:100%;position:relative;}}</style><div class="css-1l1xtmm et716sf4"><style data-emotion="css 1wipstu">.css-1wipstu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-bottom:24px;}@media (max-width: 1200px){.css-1wipstu{display:block;}}@media(max-width: 767px){.css-1wipstu{display:block;}}</style><div class="css-1wipstu ei7q9pp1"><div class="navBarWrapper"><nav class="navBarDefault"><div class="navBarHeader"><a href="https://sbopsv.github.io/cloud-tech/" class="navBarBrand"><img class="img-responsive displayInline" src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/src/components/images/favicon.png" alt="logo"/></a><div class="headerTitle displayInline">テクニカルリファレンス<img src='https://raw.githubusercontent.com/sbopsv/cloud-tech/master/src/components/images/chevron-right.svg' alt='Chevron Right' />Apache Spark on k8sからHologresへデータ連携方法</div></div></nav></div><style data-emotion="css z4d6fw">.css-z4d6fw .editOnGithub{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:right;}.css-z4d6fw .editOnGithub a{font-family:"IBM Plex Sans";font-style:normal;font-weight:300;font-size:16px;line-height:160%;-webkit-text-decoration:none;text-decoration:none;color:#1B2738;cursor:pointer;border-radius:3px;-webkit-transition:all 0.2s ease-out 0s;transition:all 0.2s ease-out 0s;-webkit-text-decoration:none;text-decoration:none;color:rgb(36, 42, 49);}.css-z4d6fw .editOnGithub a .arrow{margin-left:6px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;}.css-z4d6fw .editOnGithub a:hover .arrow{-webkit-transform:translateX(5px);-moz-transform:translateX(5px);-ms-transform:translateX(5px);transform:translateX(5px);}@media (max-width: 1200px){.css-z4d6fw .alignLeft{padding-top:12px;}}@media (min-width: 768px) and (max-width: 1199px){.css-z4d6fw{padding-top:0;}}@media(max-width: 767px){.css-z4d6fw .editOnGithub{-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding-top:24px;}.css-z4d6fw .editOnGithub .arrow{display:inline-block;}.css-z4d6fw .alignLeft{-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;}}</style><div class="css-z4d6fw ei7q9pp2"><div class="editOnGithub alignLeft"><a href="https://github.com/sbopsv/cloud-tech/tree/master/content/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres.md" class="gitBtn" target="_blank"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4yIiBiYXNlUHJvZmlsZT0idGlueSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiDQoJIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMjM1MCAyMzE0LjgiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBhdGggZD0iTTExNzUsMEM1MjUuOCwwLDAsNTI1LjgsMCwxMTc1YzAsNTUyLjIsMzc4LjksMTAxMC41LDg5MC4xLDExMzkuN2MtNS45LTE0LjctOC44LTM1LjMtOC44LTU1Ljh2LTE5OS44SDczNC40DQoJYy03OS4zLDAtMTUyLjgtMzUuMi0xODUuMS05OS45Yy0zOC4yLTcwLjUtNDQuMS0xNzkuMi0xNDEtMjQ2LjhjLTI5LjQtMjMuNS01LjktNDcsMjYuNC00NC4xYzYxLjcsMTcuNiwxMTEuNiw1OC44LDE1OC42LDEyMC40DQoJYzQ3LDYxLjcsNjcuNiw3Ni40LDE1NS43LDc2LjRjNDEuMSwwLDEwNS43LTIuOSwxNjQuNS0xMS44YzMyLjMtODIuMyw4OC4xLTE1NS43LDE1NS43LTE5MC45Yy0zOTMuNi00Ny01ODEuNi0yNDAuOS01ODEuNi01MDUuMw0KCWMwLTExNC42LDQ5LjktMjIzLjMsMTMyLjItMzE3LjNjLTI2LjQtOTEuMS02MS43LTI3OS4xLDExLjgtMzUyLjVjMTc2LjMsMCwyODIsMTE0LjYsMzA4LjQsMTQzLjljODguMS0yOS40LDE4NS4xLTQ3LDI4NC45LTQ3DQoJYzEwMi44LDAsMTk2LjgsMTcuNiwyODQuOSw0N2MyNi40LTI5LjQsMTMyLjItMTQzLjksMzA4LjQtMTQzLjljNzAuNSw3MC41LDM4LjIsMjYxLjQsOC44LDM1Mi41YzgyLjMsOTEuMSwxMjkuMywyMDIuNywxMjkuMywzMTcuMw0KCWMwLDI2NC40LTE4NS4xLDQ1OC4zLTU3NS43LDQ5OS40YzEwOC43LDU1LjgsMTg1LjEsMjE0LjQsMTg1LjEsMzMxLjlWMjI1NmMwLDguOC0yLjksMTcuNi0yLjksMjYuNA0KCUMyMDIxLDIxMjMuOCwyMzUwLDE2ODkuMSwyMzUwLDExNzVDMjM1MCw1MjUuOCwxODI0LjIsMCwxMTc1LDBMMTE3NSwweiIvPg0KPC9zdmc+DQo=" alt="Github logo"/> Edit on GitHub<div class="arrow"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.63611 11.9698C7.34322 12.2627 7.34322 12.7375 7.63611 13.0304C7.92901 13.3233 8.40388 13.3233 8.69677 13.0304L13.1968 8.53038C13.4897 8.23748 13.4897 7.76261 13.1968 7.46971L8.69677 2.96967C8.40388 2.67678 7.92901 2.67678 7.63611 2.96967C7.34322 3.26256 7.34322 3.73744 7.63611 4.03033L10.8558 7.25L2.99982 7.25C2.5856 7.25 2.24982 7.58579 2.24982 8C2.24982 8.41422 2.5856 8.75 2.99982 8.75L10.8559 8.75L7.63611 11.9698Z" fill="#1B2738"></path></svg></div></a></div></div></div><div class="titleWrapper"><h1 class="title">Apache Spark on k8sからHologresへデータ連携方法</h1></div><div class="updateWrapper"><style data-emotion="css ilvnzr">.css-ilvnzr{display:inline-block;font-size:1.0rem;font-weight:450;line-height:1.6;text-align:left;white-space:nowrap;vertical-align:middle;border-radius:0.25rem;padding:5px 12px;color:#fff;background-color:#ff6a00;}</style><span class="css-ilvnzr ei7q9pp5">作成日:<!-- -->2021/09/09</span><style data-emotion="css uoyel2">.css-uoyel2{display:-webkit-box;display:-webkit-box;display:-webkit--webkit-flex;display:-ms--webkit-flexbox;display:-webkit-flex;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:8px 12px;background-color:#ffffff;color:rgba(0,0,0,0.87);line-height:1;font-weight:600;}</style><span class="css-uoyel2 ei7q9pp3"> </span></div><div class="mainWrapper"><h2 class="heading2" id="apachesparkonk8sからhologresへデータ連携方法">Apache Spark on k8sからHologresへデータ連携方法</h2><p class="paragraph">本記事では、<a href="https://www.alibabacloud.com/product/hologres" target="_blank" rel="noopener noreferrer">Hologres</a> を使って、AzureのKubernetesサービスであるAKSからApache Sparkによるマルチクラウドーリアルタイムデータ連携する方法をご紹介します。            </p><h1 class="heading1" id="hologresとは">Hologresとは</h1><blockquote><span style="color:#ff0000"><i>Hologres はリアルタイムのインタラクティブ分析サービスです。高い同時実行性と低いレイテンシーでTB、PBクラスのデータの移動や分析を短時間で処理できます。PostgreSQL11と互換性があり、データを多次元で分析し、ビジネスインサイトを素早くキャッチすることができます。</i></span></blockquote><p class="paragraph">少し前になりますが、Hologresについての資料をSlideShareへアップロードしていますので、こちらも参考になればと思います。 </p><blockquote><p class="paragraph"><a href="https://www.slideshare.net/sbopsv/alibaba-cloud-hologres" target="_blank" rel="noopener noreferrer">https://www.slideshare.net/sbopsv/alibaba-cloud-hologres</a></p></blockquote><h1 class="heading1" id="apachesparkとは">Apache Sparkとは</h1><p class="paragraph"><a href="http://spark.apache.org/docs/latest/" target="_blank" rel="noopener noreferrer">Apache Spark</a>は、大規模データ処理のための統合分析エンジンです。複数のプログラム言語でハイレベルなAPIを提供しており、ビッグデータソリューションで人気があります。</p><blockquote><p class="paragraph"><a href="http://spark.apache.org/docs/latest/" target="_blank" rel="noopener noreferrer">http://spark.apache.org/docs/latest/</a></p></blockquote><h1 class="heading1" id="kubernetes（k8s）とは">Kubernetes（k8s）とは</h1><p class="paragraph"><a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">Kubernetes</a> は、K8sとも呼ばれ、コンテナ化されたアプリケーションのデプロイ、スケーリング、管理を自動化するためのオープンソースのシステムで、アプリケーションを構成するコンテナを論理的な単位にまとめ、管理と発見を容易にします。   </p><blockquote><p class="paragraph"><a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/</a></p></blockquote><h1 class="heading1" id="azurekubernetes上でapachesparkを使ってhologresでデータ処理をする">Azure Kubernetes上でApache Sparkを使ってHologresでデータ処理をする</h1><p class="paragraph">このガイドラインでは、Kubernetes上のApache Sparkを使って、Hologresによるデータ処理を段階的に作成します。<br/>
<!-- -->マルチクラウドによるデータ分析サービスを構築するため、Apache Sparkは<a href="https://docs.microsoft.com/ja-jp/azure/aks/" target="_blank" rel="noopener noreferrer">AKS(Azure Kubernetes Service)</a>  にてデプロイします。    </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084249.png" alt="img" title="img"/></p><h1 class="heading1" id="このチュートリアルについて">このチュートリアルについて</h1><h2 class="heading2" id="対象者:">対象者:</h2><p class="paragraph">本ガイドラインは、以下のような方を対象としています      </p><ul><li>docker、Kubernetes,、Alibaba Cloud、Hologres,、Azure、AKS(Azure Kubernetes Service) 、Azure Storage Accountに関する基本的な知識を持っている<br/></li></ul><h2 class="heading2" id="前提条件:">前提条件:</h2><ul><li>Alibaba Cloud、Azure のアカウントを所持している       </li><li>Alibaba Cloud Hologresが使用可能な状態になっている       </li><li>少なくとも1つのHologresインスタンスを持っている       </li><li>Azure AKS(Azure Kubernetes Service) と　Azure Storage Account が使用可能な状態になっている        </li><li>作業環境にAzure CLI、およびdocker(17.05以降)をインストールしている      </li></ul><h1 class="heading1" id="hologresテーブルの準備">Hologresテーブルの準備</h1><p class="paragraph">既存のHologresインスタンスに、関連データを格納するためのテーブルを作成します。     </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084305.png" alt="img" title="img"/>
<img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084313.png" alt="img" title="img"/></p><p class="paragraph">以下は生成するDDL文です     </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token constant" style="color:rgb(100, 102, 149)">BEGIN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">CREATE</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">TABLE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">public</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">book_order</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_id&quot;</span><span class="token plain"> text </span><span class="token constant" style="color:rgb(100, 102, 149)">NOT</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NULL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;user_id&quot;</span><span class="token plain"> int8 </span><span class="token constant" style="color:rgb(100, 102, 149)">NOT</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NULL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;book_id&quot;</span><span class="token plain"> int8 </span><span class="token constant" style="color:rgb(100, 102, 149)">NOT</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NULL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;book_name&quot;</span><span class="token plain"> text </span><span class="token constant" style="color:rgb(100, 102, 149)">NOT</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NULL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_cnt&quot;</span><span class="token plain"> int8 </span><span class="token constant" style="color:rgb(100, 102, 149)">NOT</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NULL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_amt&quot;</span><span class="token plain"> int8 </span><span class="token constant" style="color:rgb(100, 102, 149)">NOT</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">NULL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">PRIMARY</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">order_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">CALL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SET_TABLE_PROPERTY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;public.book_order&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orientation&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;column&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">CALL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SET_TABLE_PROPERTY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;public.book_order&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;bitmap_columns&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;order_id,book_name&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">CALL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SET_TABLE_PROPERTY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;public.book_order&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;dictionary_encoding_columns&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;order_id:auto,book_name:auto&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">CALL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SET_TABLE_PROPERTY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;public.book_order&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;time_to_live_in_seconds&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;3153600000&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">CALL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SET_TABLE_PROPERTY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;public.book_order&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;distribution_key&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;order_id&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">CALL</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">SET_TABLE_PROPERTY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;public.book_order&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;storage_format&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;orc&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">COMMIT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div></pre></pre><h1 class="heading1" id="特定データファイルおよびjarファイルを含むapachesparkのimageファイルのbuild">特定データファイルおよびjarファイルを含むApache SparkのImageファイルのbuild</h1><p class="paragraph">AKS(Azure Kubernetes Service) にApache Sparkをデプロイするためには、Sparkの実行環境、python 3環境下のPySpark、ソースデータファイル、依存関係にあるJARを含む、適切なSparkのImageを構築する必要があります。<br/>
<!-- -->以下の手順で独自のイメージを構築することもできますし、あるいはDocker Image libraryにある <code>bwbw723/spark-k8s-hologres-demo:2.4.7</code> をそのまま使うこともできます。       </p><blockquote><p class="paragraph"><a href="https://hub.docker.com/r/bwbw723/spark-k8s-hologres-demo" target="_blank" rel="noopener noreferrer">https://hub.docker.com/r/bwbw723/spark-k8s-hologres-demo</a></p></blockquote><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084330.png" alt="img" title="img"/></p><p class="paragraph">上記のパブリックイメージを使用する場合は、次のセクションから始めてください。独自のイメージを構築するには、作業環境でdockerサービスが実行されていることを確認する必要があります。     </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084345.png" alt="img" title="img"/></p><h2 class="heading2" id="apachespark用imageファイルの準備">Apache Spark用Imageファイルの準備</h2><p class="paragraph">Alibaba Cloud Log Service SDK は spark 2.x.x を必要とするので、ここでは <code>spark-2.4.7-bin-hadoop2.7</code> を使用します。</p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token plain">$ wget https</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">archive</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">apache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">org</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">dist</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2.4</span><span class="token number" style="color:rgb(181, 206, 168)">.7</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2.4</span><span class="token number" style="color:rgb(181, 206, 168)">.7</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">hadoop2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">tgz</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ tar </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">xzvf spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">2.4</span><span class="token number" style="color:rgb(181, 206, 168)">.7</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">hadoop2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">tgz</span><span class="token plain"></span></div></pre></pre><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084401.png" alt="img" title="img"/></p><h2 class="heading2" id="imageのjar依存関係とデータファイルの準備">ImageのJAR依存関係とデータファイルの準備</h2><p class="paragraph">上記のHologresテーブルのテーブルスキーマに従って、以下のスクリプトで関連するデータファイルを生成してテストすることができます。</p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> csv</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> random</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> uuid</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain">output_date </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;20210712&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">book_info </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;嫌われる勇気&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ノルウェイの森&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;海辺のカフカ&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;色彩を持たない多崎つくると彼の巡礼の年&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;容疑者Ⅹの献身&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;人間失格&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;こころ&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;天声人语&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;幸せになる勇気&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">book_price </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">600</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">700</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">350</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">550</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">650</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">csv_writer </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> csv</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">writer</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;test_data_{0}.csv&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">output_date</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;w+&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> newline</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;UTF-8&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">range</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">10000</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    book_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">randint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    order_count </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">randint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    row </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">uuid</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">uuid1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> random</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">randint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">50</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> book_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> book_info</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">book_id</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> order_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">           book_price</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">book_id</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> order_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  # order_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> book_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> book_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> order_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> order_amount</span></div><div class="token-line"><span class="token plain">    csv_writer</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">writerow</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">row</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre><p class="paragraph">以下のスクリプトを使って、関連するデータファイルを生成し、テストすることができます。     </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token plain">order_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">user_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">book_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">book_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">order_cnt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">order_amt</span></div><div class="token-line"><span class="token plain">5761158b</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">8be8</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">39</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">天声人语</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">550</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">57613ca0</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">a396</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">46</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">天声人语</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2750</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">57613ca1</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">82e5</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">13</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">容疑者Ⅹの献身</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">57613ca2</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">b395</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">35</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">容疑者Ⅹの献身</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">600</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">57613ca3</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">a123</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">42</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">色彩を持たない多崎つくると彼の巡礼の年</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">57613ca4</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">923c</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">18</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">天声人语</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2750</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">57613ca5</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">a533</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">29</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">幸せになる勇気</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1950</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">57613ca6</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">9ca4</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">35</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">7</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">こころ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1050</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">57613ca7</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f044</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">11eb</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">bd76</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">706655fcbfda</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">25</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">嫌われる勇気</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token spread operator" style="color:rgb(212, 212, 212)">...</span><span class="token plain"></span></div></pre></pre><p class="paragraph"><a href="https://mvnrepository.com/artifact/org.postgresql/postgresql" target="_blank" rel="noopener noreferrer">PostgreSQL JDBC Driver</a> の依存関係にあるJARを<a href="https://mvnrepository.com/" target="_blank" rel="noopener noreferrer">Maven Repository</a> からダウンロードします。    </p><blockquote><p class="paragraph"><a href="https://mvnrepository.com/artifact/org.postgresql/postgresql" target="_blank" rel="noopener noreferrer">https://mvnrepository.com/artifact/org.postgresql/postgresql</a></p></blockquote><blockquote><p class="paragraph"><a href="https://mvnrepository.com/" target="_blank" rel="noopener noreferrer">https://mvnrepository.com/</a></p></blockquote><p class="paragraph">spark root folder(spark-2.4.7-bin-hadoop2.7 here) と入力し、<code>demo</code>という名前の新しいフォルダ を作成し、準備したデータファイル (data.csv) 、PostgreSQLドライバ (postgresql-42.2 .6.jar) 、ログサービスのspark sdk (emr-logservice_2.11-2.2 .0.jar) とその依存関係 (fastjson-1.2 .45.jar、commons-validator-1.4 .0.jar、ezmorf-1.0 .6.jar、loghub-client-lib-0.6 .13.jar、aliyun-log-0.6 .10.jar、json-lib-2.4-jdk 15.jar、zkclient-0.10.jar、emr-common_2.11-2.2 .0.jarなど) を入れます。     </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084417.png" alt="img" title="img"/></p><h2 class="heading2" id="apachesparkimageをビルドおよびプッシュ">Apache spark imageをビルドおよびプッシュ</h2><p class="paragraph">以下の2つの点について <code>/kubernetes/dockerfiles/spark/Dockerfile</code> を更新します。     </p><ul><li>python 3実行環境を追加します。     </li><li>データファイルと依存関係JARを作業ディレクトリに置く     </li></ul><p class="paragraph">以下はDockerfileのサンプルです。</p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token constant" style="color:rgb(100, 102, 149)">FROM</span><span class="token plain"> </span><span class="token literal-property property">openjdk</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">jdk</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">slim</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">ARG</span><span class="token plain"> spark_jars</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">jars</span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">ARG</span><span class="token plain"> img_path</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">kubernetes</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">dockerfiles</span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">ARG</span><span class="token plain"> k8s_tests</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">kubernetes</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">tests</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Before</span><span class="token plain"> building the docker image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> first build and make a </span><span class="token maybe-class-name">Spark</span><span class="token plain"> distribution following</span></div><div class="token-line"><span class="token plain"># the instructions </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token literal-property property">http</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">apache</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">org</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">docs</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">latest</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">building</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">html</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">If</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">this</span><span class="token plain"> docker file is being used </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> the context </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> building your images </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> a </span><span class="token maybe-class-name">Spark</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># distribution</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> the docker build command should be invoked </span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> the top level directory</span></div><div class="token-line"><span class="token plain"># </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> the </span><span class="token maybe-class-name">Spark</span><span class="token plain"> distribution</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">E</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">g</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># docker build </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">t spark</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain">latest </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f kubernetes</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">dockerfiles</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token maybe-class-name">Dockerfile</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain"></span><span class="token constant" style="color:rgb(100, 102, 149)">RUN</span><span class="token plain"> set </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ex </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    apt</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token keyword" style="color:rgb(86, 156, 214)">get</span><span class="token plain"> update </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    ln </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">s </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">lib </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">lib64 </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    apt install </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">y bash tini libc6 libpam</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">modules libnss3 </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    mkdir </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">p </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">opt</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    mkdir </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">p </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">opt</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">work</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">dir </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    touch </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">opt</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token constant" style="color:rgb(100, 102, 149)">RELEASE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    rm </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">sh </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    ln </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">sv </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">bash </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">sh </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    echo </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;auth required pam_wheel.so use_uid&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">pam</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">d</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">su </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    chgrp root </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">passwd </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> chmod ug</span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain">rw </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">etc</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">passwd </span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;&amp;</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    rm </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">rf </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token keyword" style="color:rgb(86, 156, 214)">var</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">cache</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">apt</span><span class="token comment" style="color:rgb(106, 153, 85)">/*</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">COPY ${spark_jars} /opt/spark/jars</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">COPY bin /opt/spark/bin</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">COPY sbin /opt/spark/sbin</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">COPY ${img_path}/spark/entrypoint.sh /opt/</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">COPY examples /opt/spark/examples</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">COPY ${k8s_tests} /opt/spark/tests</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">COPY data /opt/spark/data</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">COPY python /opt/spark/python</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ENV SPARK_HOME /opt/spark</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)"># Add python3 running environment</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ENV PYTHON_VERSION=3.7.3</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN apt-get install -y \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    build-essential \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    libreadline-gplv2-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    libncursesw5-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    libssl-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    libsqlite3-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    tk-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    libgdbm-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    libc6-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    libbz2-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    libffi-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    zlib1g-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    liblzma-dev \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    wget \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    &amp;&amp; apt-get autoremove -y \</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">    &amp;&amp; apt-get clean</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">WORKDIR /usr/src</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN wget https://www.python.org/ftp/python/$PYTHON_VERSION/Python-$PYTHON_VERSION.tgz</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN tar xzf Python-$PYTHON_VERSION.tgz</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">WORKDIR /usr/src/Python-$PYTHON_VERSION</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN ./configure --enable-optimizations --with-ensurepip=install</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN make altinstall</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN ln -s /usr/local/bin/python3.7 /usr/local/bin/python3</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN ln -s /usr/local/bin/python3.7 /usr/local/bin/python</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN ln -s /usr/local/bin/pip3.7 /usr/local/bin/pip3</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN ln -s /usr/local/bin/pip3.7 /usr/local/bin/pip</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN pip install findspark</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">WORKDIR /opt/spark/work-dir</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN rm -rf /usr/src/Python-$PYTHON_VERSION</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">RUN rm -rf /usr/src/Python-$PYTHON_VERSION.tgz</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)"># Put data file and dependency JARs into work dir</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/aliyun-log-0.6.10.jar aliyun-log-0.6.10.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/fastjson-1.2.45.jar fastjson-1.2.45.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/loghub-client-lib-0.6.13.jar loghub-client-lib-0.6.13.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/ezmorph-1.0.6.jar ezmorph-1.0.6.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/emr-common_2.11-2.2.0.jar emr-common_2.11-2.2.0.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/emr-logservice_2.11-2.2.0.jar emr-logservice_2.11-2.2.0.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/commons-validator-1.4.0.jar commons-validator-1.4.0.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/postgresql-42.2.6.jar postgresql-42.2.6.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/zkclient-0.10.jar zkclient-0.10.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/json-lib-2.4-jdk15.jar json-lib-2.4-jdk15.jar</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ADD demo/data.csv data.csv</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div><div class="token-line"><span class="token comment" style="color:rgb(106, 153, 85)">ENTRYPOINT [ &quot;/opt/entrypoint.sh&quot; ]</span></div><div class="token-line"><span class="token comment" style="display:inline-block;color:rgb(106, 153, 85)">
</span></div></pre></pre><p class="paragraph"><a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub</a>、 <a href="https://docs.microsoft.com/en-us/azure/container-registry/" target="_blank" rel="noopener noreferrer">ACR(Azure Container Registry)</a>、 <a href="https://www.alibabacloud.com/cloud-tech/doc-detail/257112.htm" target="_blank" rel="noopener noreferrer">Alibaba Cloud Container Registry</a> などのコンテナイメージレジストリにログインします。ここではDocker Hubを例に説明します。      </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084439.png" alt="img" title="img"/></p><p class="paragraph"><code>&lt;spark root dir&gt;</code> に移動し、関連するコマンドを実行してイメージをビルドし、プッシュします。必要に応じて、イメージのレジストリ名やタグを変更します。      </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token plain">$ docker build </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">t bwbw723</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">k8s</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">hologres</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">demo</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">2.4</span><span class="token number" style="color:rgb(181, 206, 168)">.7</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">f </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">kubernetes</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">dockerfiles</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token maybe-class-name">Dockerfile</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token property-access">$</span><span class="token plain"> docker push bwbw723</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">k8s</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">hologres</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">demo</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">2.4</span><span class="token number" style="color:rgb(181, 206, 168)">.7</span><span class="token plain"></span></div></pre></pre><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084454.png" alt="img" title="img"/></p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084502.png" alt="img" title="img"/></p><h1 class="heading1" id="aks(azurekubernetesservice)clusterの準備">AKS(Azure Kubernetes Service) clusterの準備</h1><p class="paragraph">AKS(Azure Kubernetes Service) クラスタの作成は、<a href="https://docs.microsoft.com/en-us/azure/aks/spark-job#create-an-aks-cluster" target="_blank" rel="noopener noreferrer">Azure official help document</a>の手順に従って、Azure CLIで行うことができます。<br/>
<!-- -->Azure CLIの準備ができていない場合は、<a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli" target="_blank" rel="noopener noreferrer">Install Azure CLI</a>と<a href="https://docs.microsoft.com/en-us/cli/azure/authenticate-azure-cli" target="_blank" rel="noopener noreferrer">Sign in</a>を参照してください。       </p><blockquote><p class="paragraph"><a href="https://docs.microsoft.com/en-us/azure/aks/spark-job#create-an-aks-cluster" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/azure/aks/spark-job#create-an-aks-cluster</a></p></blockquote><blockquote><p class="paragraph"><a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/cli/azure/install-azure-cli</a></p></blockquote><blockquote><p class="paragraph"><a href="https://docs.microsoft.com/en-us/cli/azure/authenticate-azure-cli" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/cli/azure/authenticate-azure-cli</a></p></blockquote><p class="paragraph">コマンドは次の通りです。       </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Install</span><span class="token plain"> </span><span class="token maybe-class-name">Azure</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">CLI</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ curl </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token constant" style="color:rgb(100, 102, 149)">L</span><span class="token plain"> </span><span class="token literal-property property">https</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">aka</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">ms</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token maybe-class-name">InstallAzureCli</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> bash</span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Sign</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ az login</span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Create</span><span class="token plain"> a resource group </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> the cluster</span></div><div class="token-line"><span class="token plain">$ az group create </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">resource group name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token dom variable" style="color:rgb(156, 220, 254)">location</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">group </span><span class="token dom variable" style="color:rgb(156, 220, 254)">location</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Create</span><span class="token plain"> a </span><span class="token maybe-class-name">Service</span><span class="token plain"> </span><span class="token maybe-class-name">Principal</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> the cluster</span></div><div class="token-line"><span class="token plain">$ az ad sp create</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">for</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">rbac </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">service principal name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Create</span><span class="token plain"> the </span><span class="token constant" style="color:rgb(100, 102, 149)">AKS</span><span class="token plain"> cluster </span><span class="token keyword" style="color:rgb(86, 156, 214)">with</span><span class="token plain"> nodes that are </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> size </span><span class="token maybe-class-name">Standard_DS2_v2</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ az aks create </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">resource</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">group </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above resource group name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">aks cluster name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">node</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">vm</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">size </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">node vm size such </span><span class="token keyword module" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> </span><span class="token maybe-class-name">Standard_DS2_v2</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">generate</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ssh</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">keys </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">service</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">principal </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token constant" style="color:rgb(100, 102, 149)">APPID</span><span class="token plain"> generated above</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">client</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">secret </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token constant" style="color:rgb(100, 102, 149)">PASSWORD</span><span class="token plain"> generated above</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Get</span><span class="token plain"> credentials </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> cluster connection</span></div><div class="token-line"><span class="token plain">$ az aks get</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">credentials </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">resource</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">group </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above resource group name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above aks cluster name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div></pre></pre><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084515.png" alt="img" title="img"/></p><h1 class="heading1" id="pysparkでスパークジョブの準備">PySparkでスパークジョブの準備</h1><p class="paragraph">Sparkは複数のプログラム言語をサポートしており、ここではpythonとPySparkを例にしています。タスクが完了すると、スパークイメージで用意したCSVファイルに含まれる全てのレコードが対象のHologresテーブルに保存されます。<br/>
<!-- -->DataFrameReaderの<code>csv(&quot;path&quot;)</code>または<code>format(&quot;csv&quot;).load(&quot;path&quot;)</code>を使うと、CSVファイルをPySparkのDataFrameに読み込むことができます。また、<a href="http://spark.apache.org/docs/latest/api/scala/org/apache/spark/rdd/JdbcRDD.html" target="_blank" rel="noopener noreferrer">JdbcRDD</a>を使えば、特定のドライバを使って簡単にデータベースにDataFrameを書き込むことができます。    </p><p class="paragraph">この状態ではHologresインスタンスはPostgreSQLとして接続されています。詳しい情報は、<a href="http://spark.apache.org/docs/latest/sql-data-sources-jdbc.html" target="_blank" rel="noopener noreferrer">spark JDBC data source</a>や<a href="http://spark.apache.org/docs/latest/sql-data-sources-load-save-functions.html" target="_blank" rel="noopener noreferrer">spark generic file source</a>を参照してください。     </p><p class="paragraph">以下のスクリプトで <code>hologres_spark.py</code> を作成します。     </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> findspark</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain">findspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">sql</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">SparkSession</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">sql</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">types</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token maybe-class-name">StructType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">StringType</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;__main__&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    spark </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token maybe-class-name">SparkSession</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">builder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">appName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;HologresSparkDemo&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">getOrCreate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    schema </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">StructType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">StringType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;user_id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;book_id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;book_name&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">StringType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_cnt&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_amt&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    df_with_schema </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">read</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;csv&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;header&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">schema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">load</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your file path in spark image, such as /opt/spark/work-dir/data.csv&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    df_with_schema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">write</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">mode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;append&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;jdbc&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;url&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;JDBC connection url of your instance, e.g. jdbc:postgresql://&lt;endpoint&gt;:&lt;port&gt;/&lt;database name&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;dbtable&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your target table name&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your accessKeyId&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;password&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your accessKeySecret&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;driver&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;org.postgresql.Driver&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">save</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div></pre></pre><h1 class="heading1" id="submitsparkjob">Submit spark job</h1><p class="paragraph">pythonスクリプトをAzure blob storageに置くには、<a href="https://docs.microsoft.com/en-us/azure/aks/spark-job#copy-job-to-storage" target="_blank" rel="noopener noreferrer">この手順</a>に従って配置する必要があります。     </p><blockquote><p class="paragraph"><a href="https://docs.microsoft.com/en-us/azure/aks/spark-job#copy-job-to-storage" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/azure/aks/spark-job#copy-job-to-storage</a></p></blockquote><p class="paragraph">コマンドは次の通りです。     </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Create</span><span class="token plain"> storage account</span></div><div class="token-line"><span class="token plain">$ az storage account create </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">resource</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">group </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above resource group name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">storage account name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">sku </span><span class="token maybe-class-name">Standard_LRS</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Export</span><span class="token plain"> </span><span class="token maybe-class-name">Azure</span><span class="token plain"> storage connection string</span></div><div class="token-line"><span class="token plain">$ </span><span class="token keyword module" style="color:rgb(86, 156, 214)">export</span><span class="token plain"> </span><span class="token constant" style="color:rgb(100, 102, 149)">AZURE_STORAGE_CONNECTION_STRING</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token template-string template-punctuation string" style="color:rgb(206, 145, 120)">`</span><span class="token template-string string" style="color:rgb(206, 145, 120)">az storage account show-connection-string --resource-group &lt;above resource group name&gt; --name &lt;above storage account name&gt; -o tsv</span><span class="token template-string template-punctuation string" style="color:rgb(206, 145, 120)">`</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Create</span><span class="token plain"> storage container</span></div><div class="token-line"><span class="token plain">$ az storage container create </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">container name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># </span><span class="token known-class-name class-name" style="color:rgb(78, 201, 176)">Set</span><span class="token plain"> container permission </span><span class="token keyword module" style="color:rgb(86, 156, 214)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">public</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ az storage container set</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">permission </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above container name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token keyword" style="color:rgb(86, 156, 214)">public</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">access blob</span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Upload</span><span class="token plain"> python script into container</span></div><div class="token-line"><span class="token plain">$ az storage blob upload </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">container</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above container name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">file </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">local file path</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">file name </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> container</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># </span><span class="token maybe-class-name">Get</span><span class="token plain"> access url </span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> uploaded python script</span></div><div class="token-line"><span class="token plain">$ scriptUrl</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token function" style="color:rgb(220, 220, 170)">$</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">az storage blob url </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">container</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above container name</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above file name </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> container</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> tr </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">d </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div></pre></pre><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084538.png" alt="img" title="img"/></p><p class="paragraph">ここでは<a href="https://docs.microsoft.com/en-us/azure/aks/spark-job#submit-a-spark-job" target="_blank" rel="noopener noreferrer">Spark Jobをsubmitする方法</a>を説明します。<br/>
<code>kubectl proxy</code>を実行して、kube-proxyを別のコマンドラインで起動します。    </p><blockquote><p class="paragraph"><a href="https://docs.microsoft.com/en-us/azure/aks/spark-job#submit-a-spark-job" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/azure/aks/spark-job#submit-a-spark-job</a></p></blockquote><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084552.png" alt="img" title="img"/></p><p class="paragraph">先ほど前のコマンドラインに戻り、以下のようにサービスアカウントとクラスターを作成します。     </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token plain">$ kubectl create serviceaccount spark</span></div><div class="token-line"><span class="token plain">$ kubectl create clusterrolebinding spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">role </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">clusterrole</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">edit </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">serviceaccount</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token keyword module" style="color:rgb(86, 156, 214)">default</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain">spark </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">namespace</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token keyword module" style="color:rgb(86, 156, 214)">default</span><span class="token plain"></span></div></pre></pre><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084605.png" alt="img" title="img"/></p><p class="paragraph">PySparkタスクをAKS (Azure Kubernetes Service) クラスターにSubmit します。必要に応じて、image 情報とFile pathを更新します。    </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">submit \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">master k8s</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">http</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token number" style="color:rgb(181, 206, 168)">127.0</span><span class="token number" style="color:rgb(181, 206, 168)">.0</span><span class="token number" style="color:rgb(181, 206, 168)">.1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">8001</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">deploy</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">mode cluster \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name hologres</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">spark \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">conf spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">executor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">instances</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">conf spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">kubernetes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">authenticate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">driver</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">serviceAccountName</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">spark \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">conf spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">kubernetes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">container</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">pullPolicy</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token maybe-class-name">Always</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">conf spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">kubernetes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">container</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">image</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">bwbw723</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">k8s</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">hologres</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">demo</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">2.4</span><span class="token number" style="color:rgb(181, 206, 168)">.7</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">driver</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">path local</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token comment" style="color:rgb(106, 153, 85)">//opt/spark/work-dir/postgresql-42.2.6.jar \</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">jars local</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token comment" style="color:rgb(106, 153, 85)">//opt/spark/work-dir/postgresql-42.2.6.jar \</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">above scriptUrl</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div></pre></pre><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084617.png" alt="img" title="img"/></p><p class="paragraph"><code>kubectl get pods</code>で実際のPod情報を確認します。      </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084629.png" alt="img" title="img"/></p><p class="paragraph">Hologresテーブルのレコードをチェックします。     </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084641.png" alt="img" title="img"/></p><p class="paragraph">##PySparkでspark streaming jobを準備する</p><p class="paragraph"><a href="https://www.alibabacloud.com/cloud-tech/doc-detail/51075.htm" target="_blank" rel="noopener noreferrer">Alibaba Cloudが提供するSpark SDK</a> を使用すると、LogServiceでReceiver（受信モード）もしくはDirect（直接モード）でログデータを受け取りすることが出来ます。関連情報およびソースとして <a href="https://github.com/aliyun/aliyun-emapreduce-datasources/tree/master-2.x/emr-logservice" target="_blank" rel="noopener noreferrer">Git aliyun-emapreduce-datasources</a>  および、<a href="https://github.com/aliyun/aliyun-emapreduce-demo" target="_blank" rel="noopener noreferrer">Git aliyun-emapreduce-demo</a> にて詳しい説明があります。         </p><blockquote><p class="paragraph"><a href="https://www.alibabacloud.com/cloud-tech/doc-detail/51075.htm" target="_blank" rel="noopener noreferrer">https://www.alibabacloud.com/cloud-tech/doc-detail/51075.htm</a></p></blockquote><p class="paragraph">Spark SDKを使って、DataStreamReaderはログサービスを <code>loghub</code> フォーマットとして認識することができました。
Pythonの使い方については、<a href="https://github.com/aliyun/aliyun-emapreduce-datasources/blob/main/docs/how_to_run_spark_with_python_sdk.md" target="_blank" rel="noopener noreferrer">こちら</a>を参照してください。</p><blockquote><p class="paragraph"><a href="https://github.com/aliyun/aliyun-emapreduce-datasources/blob/main/docs/how_to_run_spark_with_python_sdk.md" target="_blank" rel="noopener noreferrer">https://github.com/aliyun/aliyun-emapreduce-datasources/blob/main/docs/how_to_run_spark_with_python_sdk.md</a></p></blockquote><p class="paragraph">以下のスクリプトで<code>holres_spark_streaming.py</code>を作成します。</p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> findspark</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain">findspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">sql</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">SparkSession</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">sql</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">types</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> </span><span class="token maybe-class-name">StructType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">StringType</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain">def </span><span class="token function" style="color:rgb(220, 220, 170)">foreach_batch_function</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token parameter">df</span><span class="token parameter punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token parameter"> epoch_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    df</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">write</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">mode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;append&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;jdbc&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;url&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;public JDBC connection url of your instance, e.g. jdbc:postgresql://&lt;endpoint&gt;:&lt;port&gt;/&lt;database name&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;dbtable&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your target table name&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your accessKeyId&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;password&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your accessKeySecret&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;driver&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;org.postgresql.Driver&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">save</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    pass</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:rgb(212, 212, 212)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;__main__&#x27;</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    spark </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token maybe-class-name">SparkSession</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">builder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">appName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;HologresSparkStreamingDemo&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">getOrCreate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    schema </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">StructType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">StringType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;user_id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;book_id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;book_name&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">StringType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_cnt&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;order_amt&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(220, 220, 170)">IntegerType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token maybe-class-name">True</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    line_with_schema </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">readStream</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;loghub&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">schema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;sls.project&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your log service project name&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;sls.store&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your log service logstore name&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;access.key.id&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your accessKeyId&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;access.key.secret&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your accessKeySecret&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;endpoint&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your endpoint such as ap-northeast-1.log.aliyuncs.com&gt;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">option</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;startingoffsets&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;latest&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">load</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    stream </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> line_with_schema</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">writeStream</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">foreachBatch</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">foreach_batch_function</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">start</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    stream</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">awaitTermination</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div></pre></pre><h1 class="heading1" id="データ転送のためにalibabacloudlogserviceのリソース準備">データ転送のためにAlibaba Cloud Log Serviceのリソース準備</h1><p class="paragraph">Alibaba Cloudコンソールに入り、Log ServiceプロジェクトとLogStoreを準備します。LogStoreを作成するときは、WebTrackingが有効になっていることを確認します。      </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084658.png" alt="img" title="img"/>
<img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084707.png" alt="img" title="img"/>
<img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084717.png" alt="img" title="img"/>
<img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084726.png" alt="img" title="img"/></p><p class="paragraph">logstore dataを入力し、インデックス属性を有効にします。　   </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084739.png" alt="img" title="img"/>
<img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084746.png" alt="img" title="img"/>
<img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084755.png" alt="img" title="img"/>
<img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084803.png" alt="img" title="img"/></p><h1 class="heading1" id="sparkstreamingjobの実行">Spark streaming jobの実行</h1><p class="paragraph">まずはHologresのテーブルデータをDELETEらSQLクエリでクリアします。    </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084816.png" alt="img" title="img"/></p><p class="paragraph">Azure CLI (<code>az storage blob upload ...</code>) またはAzure Portalで、事前に作成したSpark streamingスクリプトをAzure blobストレージにアップロードします。     </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084829.png" alt="img" title="img"/></p><p class="paragraph">アップロードされたスクリプトのアクセスURLを取得します。      </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084841.png" alt="img" title="img"/></p><p class="paragraph">作業環境のコマンドラインに戻り、AKS(Azure Kubernetes Service)クラスタにSpark streaming Taskを投入します。     </p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">bin</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">submit \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">master k8s</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">http</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token number" style="color:rgb(181, 206, 168)">127.0</span><span class="token number" style="color:rgb(181, 206, 168)">.0</span><span class="token number" style="color:rgb(181, 206, 168)">.1</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">8001</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">deploy</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">mode cluster \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">name hologres</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">streaming \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">conf spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">executor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">instances</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">conf spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">kubernetes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">authenticate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">driver</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">serviceAccountName</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">spark \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">conf spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">kubernetes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">container</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">image</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">pullPolicy</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token maybe-class-name">Always</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">conf spark</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">kubernetes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">container</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token property-access">image</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">bwbw723</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">spark</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">k8s</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">hologres</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">demo</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token number" style="color:rgb(181, 206, 168)">2.4</span><span class="token number" style="color:rgb(181, 206, 168)">.7</span><span class="token plain"> \</span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">driver</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">path local</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token comment" style="color:rgb(106, 153, 85)">//opt/spark/work-dir/postgresql-42.2.6.jar \</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">--</span><span class="token plain">jars local</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token comment" style="color:rgb(106, 153, 85)">//opt/spark/work-dir/postgresql-42.2.6.jar,local:///opt/spark/work-dir/fastjson-1.2.45.jar,local:///opt/spark/work-dir/commons-validator-1.4.0.jar,local:///opt/spark/work-dir/ezmorph-1.0.6.jar,local:///opt/spark/work-dir/emr-logservice_2.11-2.2.0.jar,local:///opt/spark/work-dir/loghub-client-lib-0.6.13.jar,local:///opt/spark/work-dir/aliyun-log-0.6.10.jar,local:///opt/spark/work-dir/json-lib-2.4-jdk15.jar,local:///opt/spark/work-dir/zkclient-0.10.jar,local:///opt/spark/work-dir/emr-common_2.11-2.2.0.jar \</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">access url </span><span class="token keyword" style="color:rgb(86, 156, 214)">of</span><span class="token plain"> your spark streaming script</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div></pre></pre><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084856.png" alt="img" title="img"/></p><p class="paragraph"><code>kubectl get pods</code> で realted pod 情報を確認します。       </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084909.png" alt="img" title="img"/></p><p class="paragraph">Spark streaming job の実行中に、以下のスクリプトで新しいLog Serviceのレコードを送信し、関連するログを確認します。</p><pre class="pre"><pre class="prism-code language-javascript pre" style="color:#9CDCFE;background-color:#1E1E1E;padding:2rem;position:relative" p="3"><button style="position:absolute;top:0;right:0;border:none;box-shadow:none;text-decoration:none;margin:8px;padding:8px 12px;background:#E2E8F022;color:#E2E8F0;border-radius:8px;cursor:pointer;font-size:14px;font-family:sans-serif;line-height:1">Copy</button><div class="token-line"><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> random</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> requests</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module" style="color:rgb(86, 156, 214)">import</span><span class="token plain"> uuid</span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line"><span class="token plain">project </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your log service project name&gt;&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">endpoint </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your endpoint such as ap-northeast-1.log.aliyuncs.com&gt;&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">logstore </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your log service logstore name&gt;&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">topic </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;your logs topic&gt;&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"># urlencoded book name </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token maybe-class-name">Japanese</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">book_info </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E5%AB%8C%E3%82%8F%E3%82%8C%E3%82%8B%E5%8B%87%E6%B0%97&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E3%83%8E%E3%83%AB%E3%82%A6%E3%82%A7%E3%82%A4%E3%81%AE%E6%A3%AE&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E6%B5%B7%E8%BE%BA%E3%81%AE%E3%82%AB%E3%83%95%E3%82%AB&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E8%89%B2%E5%BD%A9%E3%82%92%E6%8C%81%E3%81%9F%E3%81%AA%E3%81%84%E5%A4%9A%E5%B4%8E%E3%81%A4%E3%81%8F%E3%82%8B%E3%81%A8%E5%BD%BC%E3%81%AE%E5%B7%A1%E7%A4%BC%E3%81%AE%E5%B9%B4&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E5%AE%B9%E7%96%91%E8%80%85%E2%85%A9%E3%81%AE%E7%8C%AE%E8%BA%AB&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E4%BA%BA%E9%96%93%E5%A4%B1%E6%A0%BC&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E3%81%93%E3%81%93%E3%82%8D&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E5%A4%A9%E5%A3%B0%E4%BA%BA%E8%AF%AD&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%E5%B9%B8%E3%81%9B%E3%81%AB%E3%81%AA%E3%82%8B%E5%8B%87%E6%B0%97&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">book_price </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">600</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">700</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">350</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">550</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">650</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">url </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;http://{0}.{1}/logstores/{2}/track?APIVersion=0.6.0&amp;__topic__={3}&amp;order_id={4}&amp;user_id={5}&amp;book_id={6}&amp;book_name={7}&amp;order_cnt={8}&amp;order_amt={9}&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword control-flow" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">range</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    book_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">randint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    order_count </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">randint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    res </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">get</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        url</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">format</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">project</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> endpoint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> logstore</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> topic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> uuid</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">uuid1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> random</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token method function property-access" style="color:rgb(220, 220, 170)">randint</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">50</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> book_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                   book_info</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">book_id </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> order_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                   book_price</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">book_id </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> order_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">print</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">res</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain" style="display:inline-block">
</span></div></pre></pre><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084924.png" alt="img" title="img"/></p><p class="paragraph">今度はHologresでレコードを確認します。     </p><p class="paragraph"><img src="https://raw.githubusercontent.com/sbopsv/cloud-tech/master/content/usecase-Hologres/Hologres_images_26006613798077100/20210909084935.png" alt="img" title="img"/></p><h1 class="heading1" id="最後に">最後に</h1><p class="paragraph">ここまで、Azureのk8s（AKS）にApache Sparkを配置し、Hologresへデータ連携する方法を紹介しました。<br/>
<!-- -->この方法を生かすことで、Alibaba Cloudでない、他社クラウドサービスからApache Spark on k8sを使ってk8sのサービス基盤からリアルタイムでHologresへ連携、Hologresでリアルタイム可視化を実現することができます。      </p><div id="floating-subscribe" class="floatingSubscribeVisible"><div class="floating-subscribe-wrapper mt-16"><div role="button" tabindex="0" class="floating-subscribe-close"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDE2SDIyIiBzdHJva2U9IiNBOEE4QTgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xIDE2QzEgMTkuOTc4MiAyLjU4MDM1IDIzLjc5MzYgNS4zOTM0IDI2LjYwNjZDOC4yMDY0NCAyOS40MTk2IDEyLjAyMTggMzEgMTYgMzFDMTkuOTc4MiAzMSAyMy43OTM2IDI5LjQxOTYgMjYuNjA2NiAyNi42MDY2QzI5LjQxOTYgMjMuNzkzNiAzMSAxOS45NzgyIDMxIDE2QzMxIDEyLjAyMTggMjkuNDE5NiA4LjIwNjQ0IDI2LjYwNjYgNS4zOTM0QzIzLjc5MzYgMi41ODAzNSAxOS45NzgyIDEgMTYgMUMxMi4wMjE4IDEgOC4yMDY0NCAyLjU4MDM1IDUuMzkzNCA1LjM5MzRDMi41ODAzNSA4LjIwNjQ0IDEgMTIuMDIxOCAxIDE2VjE2WiIgc3Ryb2tlPSIjQThBOEE4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K" alt="Close"/></div><h2 class="pr-40">Alibaba Cloudを始めてみましょう</h2><div class="post-subscription-description">ソフトバンクは、Alibaba Cloudのアカウント開設から、サービス展開までをお手伝いします。</div><div class="buttonWrapper"><a href="https://tm.softbank.jp/form/cloud/iaas/index.php?ref=lp-alibaba" target="_blank" rel="noopener noreferrer"><button class="subscribeBtn">お問い合わせ窓口</button></a></div></div></div><div class="floatingShareWrapper"><a class="shareIcon" href="https://getpocket.com/save?url=https://sbopsv.github.io/cloud-tech/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres" target="_blank" rel="nofollow noopener noreferrer" data-save-url="https://sbopsv.github.io/cloud-tech/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres" data-pocket-count="vertical" data-pocket-align="left"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzgiIGhlaWdodD0iMzQiIHZpZXdCb3g9IjAgMCAzOCAzNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yLjMzMDM2IDAuNjg3NUgzNC45NTU0QzM2LjI0MTcgMC42ODc1IDM3LjI4NTcgMS43MzM4MyAzNy4yODU3IDMuMDE3ODZWMTUuODM0OEMzNy4yODU3IDI1LjQ3MzIgMjkuNDQ2NCAzMy4zMTI1IDE5LjgwOCAzMy4zMTI1SDE3LjQ3NzdDNy44MzkzMiAzMy4zMTI1IDAgMjUuNDczMiAwIDE1LjgzNDhWMy4wMTc4NkMwIDEuNzMzODMgMS4wNDYzMyAwLjY4NzUgMi4zMzAzNiAwLjY4NzVaTTE2Ljk5NTQgMjMuMzA4MkMxNy40NDk4IDIzLjc2MjYgMTguMDQ2MyAyMy45OTA5IDE4LjY0MjkgMjMuOTkwOUMxOS4yMzk0IDIzLjk5MDkgMTkuODM2IDIzLjc2MjYgMjAuMjkwNCAyMy4zMDgyTDI5LjYxMTMgMTMuOTg3MUMzMC41MjI1IDEzLjA3NiAzMC41MjI1IDExLjYwMzMgMjkuNjExMyAxMC42OTIyQzI4LjcwMDIgOS43ODEwMiAyNy4yMjc1IDkuNzgxMDIgMjYuMzE2NCAxMC42OTIyTDE4LjY0MjkgMTguMzY1N0wxMC45Njk0IDEwLjY5MjJDMTAuMDU4MyA5Ljc4MTAyIDguNTg1NTcgOS43ODEwMiA3LjY3NDQ1IDEwLjY5MjJDNi43NjMzMiAxMS42MDMzIDYuNzYzMzIgMTMuMDc2IDcuNjc0NDUgMTMuOTg3MUwxNi45OTU0IDIzLjMwODJaIiBmaWxsPSIjQThBOEE4Ii8+Cjwvc3ZnPgo=" alt="Pocket"/></a><div class="shareIcon"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzMiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMyAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTMwLjA4ODkgMi4xOTY3NkMyNy4xNTk5IC0wLjczMjI0MyAyMi40MTEzIC0wLjczMjI0MyAxOS40ODIzIDIuMTk2N0wxMy4yMTM5IDguNDY1MDhDMTAuMTg0MiAxMS40OTQ5IDEwLjQ2NDcgMTYuMzIyNCAxMy4yMTM5IDE5LjA3MTdDMTMuNjc0MyAxOS41MzIxIDE0LjE4MzYgMTkuOTA3NSAxNC43MjE1IDIwLjIxNThMMTUuODY1NiAxOS4wNzE3QzE2LjYxNiAxOC4zMjEyIDE2LjM1MTggMTcuNDQzOSAxNi4zMzgzIDE2LjgxMDhDMTYuMTczNiAxNi42OTQxIDE2LjAxMzUgMTYuNTY3OSAxNS44NjU2IDE2LjQyQzE0LjQ1NDggMTUuMDA5MyAxNC4zOTEzIDEyLjU5MSAxNS44NjU2IDExLjExNjdDMTYuMDg0NSAxMC44OTc4IDIyLjAwMSA0Ljk4MTMzIDIyLjEzMzggNC44NDg0NUMyMy41OTYzIDMuMzg2MDEgMjUuOTc0NyAzLjM4NjAxIDI3LjQzNzIgNC44NDg0NUMyOC44OTk2IDYuMzEwODkgMjguODk5NiA4LjY4OTMzIDI3LjQzNzIgMTAuMTUxOEwyMy4yOTM4IDE0LjI5NTFDMjMuNDEzNyAxNC45NTggMjQuMTMyNyAxNi41Mjg0IDIzLjc2MjggMTkuMTE4OUMyMy43ODA5IDE5LjEwMTIgMjMuODAyNSAxOS4wODk3IDIzLjgyMDUgMTkuMDcxOEwzMC4wODg5IDEyLjgwMzRDMzMuMDE3OCA5Ljg3NDM5IDMzLjAxNzggNS4xMjU3NiAzMC4wODg5IDIuMTk2NzZaIiBmaWxsPSIjQThBOEE4Ii8+CjxwYXRoIGQ9Ik0xOS44NDMgMTIuNDQyOUMxOS4zODI3IDExLjk4MjUgMTguODczMyAxMS42MDcxIDE4LjMzNTUgMTEuMjk4OEwxNy4xOTE0IDEyLjQ0MjlDMTYuNDQwOSAxMy4xOTMzIDE2LjcwNTEgMTQuMDcwNiAxNi43MTg2IDE0LjcwMzZDMTYuODgzNCAxNC44MjA0IDE3LjA0MzYgMTQuOTQ2NiAxNy4xOTE0IDE1LjA5NDVDMTguNjAyMyAxNi41MDUzIDE4LjY2NTcgMTguOTIzNSAxNy4xOTE0IDIwLjM5NzhDMTYuOTcyIDIwLjYxNzIgMTAuNTY1NSAyNy4wMjM3IDEwLjQzNzMgMjcuMTUxOUM4Ljk3NDg3IDI4LjYxNDMgNi41OTY0MyAyOC42MTQzIDUuMTMzOTkgMjcuMTUxOUMzLjY3MTU1IDI1LjY4OTUgMy42NzE1NSAyMy4zMTEgNS4xMzM5OSAyMS44NDg2TDkuNzYzMTkgMTcuMjE5NEM5LjY0MzM3IDE2LjU1NjUgOC45MjQyNSAxNC45ODYxIDkuMjk0MTkgMTIuMzk1NkM5LjI3NjEyIDEyLjQxMzMgOS4yNTQzNyAxMi40MjQ5IDkuMjM2MzcgMTIuNDQyOEwyLjQ4MjMgMTkuMTk3Qy0wLjQ0NjU3NSAyMi4xMjYgLTAuNDQ2NTc1IDI2Ljg3NDcgMi40ODIzIDI5LjgwMzdDNS40MTEzMSAzMi43MzI1IDEwLjE1OTkgMzIuNzMyNSAxMy4wODg5IDI5LjgwMzdMMTkuODQzIDIzLjA0OTVDMjIuODE2NSAyMC4wNzYgMjIuNjU0IDE1LjI1MzggMTkuODQzIDEyLjQ0MjlaIiBmaWxsPSIjQThBOEE4Ii8+Cjwvc3ZnPgo=" alt="Copy"/></div><a class="HatenaShareButton" href="http://b.hatena.ne.jp/add?mode=confirm&amp;url=https://sbopsv.github.io/cloud-tech/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres+&amp;title=Apache Spark on k8sからHologresへデータ連携方法" target="_blank" rel="nofollow noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MDAgNTAwIj4KCTxyZWN0IHdpZHRoPSI1MDAiIGhlaWdodD0iNTAwIiByeD0iMTAxLjkiIHJ5PSIxMDEuOSIgZmlsbD0iIzAwYTRkZSIvPgoJPGcgZmlsbD0iI2ZmZiI+CgkJPHBhdGggZD0iTTI3OC4yLDI1OC4xcS0xMy42LTE1LjItMzcuOC0xN2MxNC40LTMuOSwyNC44LTkuNiwzMS40LTE3LjNzOS44LTE3LjgsOS44LTMwLjdBNTUsNTUsMCwwLDAsMjc1LDE2NmE0OC44LDQ4LjgsMCwwLDAtMTkuMi0xOC42Yy03LjMtNC0xNi02LjktMjYuMi04LjZzLTI4LjEtMi40LTUzLjctMi40SDExMy42VjM2My42aDY0LjJxMzguNywwLDU1LjgtMi42YzExLjQtMS44LDIwLjktNC44LDI4LjYtOC45YTUyLjUsNTIuNSwwLDAsMCwyMS45LTIxLjRjNS4xLTkuMiw3LjctMTkuOSw3LjctMzIuMUMyOTEuOCwyODEuNywyODcuMywyNjguMiwyNzguMiwyNTguMVptLTEwNy03MS40aDEzLjNxMjMuMSwwLDMxLDUuMmM1LjMsMy41LDcuOSw5LjUsNy45LDE4cy0yLjksMTQtOC41LDE3LjQtMTYuMSw1LTMxLjQsNUgxNzEuMlYxODYuN1ptNTIuOCwxMzAuM2MtNi4xLDMuNy0xNi41LDUuNS0zMS4xLDUuNUgxNzEuMlYyNzNoMjIuNmMxNSwwLDI1LjQsMS45LDMwLjksNS43czguNCwxMC40LDguNCwyMFMyMzAuMSwzMTMuNCwyMjMuOSwzMTcuMVoiLz4KCQk8cGF0aCBkPSJNMzU3LjYsMzA2LjFhMjguOCwyOC44LDAsMSwwLDI4LjgsMjguOEEyOC44LDI4LjgsMCwwLDAsMzU3LjYsMzA2LjFaIi8+CgkJPHJlY3QgeD0iMzMyLjYiIHk9IjEzNi40IiB3aWR0aD0iNTAiIGhlaWdodD0iMTUxLjUyIi8+Cgk8L2c+Cjwvc3ZnPgo=" alt="Hatena"/></a><a class="shareIcon" href="https://www.facebook.com/sharer/sharer.php?u=https://sbopsv.github.io/cloud-tech/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres" target="_blank" rel="nofollow noopener noreferrer"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjIxNDM3OTgyOTIxIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjIyNjAiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwQzIyOS4wNTI2MzIgMCAwIDIyOS4wNTI2MzIgMCA1MTJzMjI5LjA1MjYzMiA1MTIgNTEyIDUxMiA1MTItMjI5LjA1MjYzMiA1MTItNTEyUzc5NC45NDczNjggMCA1MTIgMHogbTEyMi43NDUyNjMgNTEyaC03OS4zODY5NDd2MjY5LjQ3MzY4NGgtMTE3LjkyMTY4NFY1MTJIMzc3LjI2MzE1OHYtOTIuODMzNjg0aDYwLjE3MzQ3NHYtNTYuNjQzMzY5YzAtNzQuNjk4MTA1IDMzLjY4NDIxMS0xMTkuOTk2NjMyIDEyNy41MTQ5NDctMTE5Ljk5NjYzMWg3OS4zODY5NDd2OTIuODMzNjg0aC00OC4xMjhjLTM2LjEwOTQ3NCAwLTM4LjQ4MDg0MiAxMy42MDg0MjEtMzguNDgwODQyIDM2LjIxNzI2M3Y0NS4yOTg1MjZINjQ2LjczNjg0Mkw2MzQuNzE4MzE2IDUxMnoiIGZpbGw9IiMzYjU5OTgiIHAtaWQ9IjIyNjEiPjwvcGF0aD48L3N2Zz4=" alt="Facebook"/></a><a class="shareIcon" href="https://twitter.com/intent/tweet?&amp;text=Apache Spark on k8sからHologresへデータ連携方法&amp;url=https://sbopsv.github.io/cloud-tech/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres" target="_blank" rel="nofollow noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDEiIGhlaWdodD0iMzQiIHZpZXdCb3g9IjAgMCA0MSAzNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQwLjU2MDMgNC41MjU3M0MzOS4wNjk2IDUuMTk3NDMgMzcuNDYyOCA1LjYzODgyIDM1Ljc5NzkgNS44NDk5M0MzNy41MDE1IDQuODMyNzkgMzguODE4IDMuMjIwNzMgMzkuNDM3NSAxLjI4MjQzQzM3LjgzMDYgMi4yNDE5OSAzNi4wNDk1IDIuOTEzNjggMzQuMTcxNyAzLjI5NzVDMzIuNjQyMyAxLjY0NzA2IDMwLjQ5MzQgMC42ODc1IDI4LjA1NDEgMC42ODc1QzIzLjUwNDYgMC42ODc1IDE5Ljc4NzYgNC4zNzIyMSAxOS43ODc2IDguOTIwNTFDMTkuNzg3NiA5LjU3MzAxIDE5Ljg2NSAxMC4yMDYzIDIwLjAwMDYgMTAuODAxMkMxMy4xMDg2IDEwLjQ1NTggNi45NzE2MyA3LjE3NDEyIDIuODg2NzggMi4yMDM2QzIuMTcwNDggMy40MTI2NSAxLjc2Mzk0IDQuODMyNzkgMS43NjM5NCA2LjMyOTcxQzEuNzYzOTQgOS4xODkxOSAzLjIxNTkgMTEuNzIyNCA1LjQ2MTU5IDEzLjE2MThDNC4wODcwNyAxMy4xNjE4IDIuODA5MzUgMTIuNzc3OSAxLjY4NjUgMTIuMjAyMkMxLjY4NjUgMTIuMjAyMiAxLjY4NjUgMTIuMjAyMiAxLjY4NjUgMTIuMjU5OEMxLjY4NjUgMTYuMjUxNSA0LjU1MTcgMTkuNTkwOCA4LjM0NjE1IDIwLjMzOTNDNy42NDkyMSAyMC41MzEyIDYuOTEzNTUgMjAuNjI3MSA2LjE1ODUzIDIwLjYyNzFDNS42MzU4MyAyMC42MjcxIDUuMTEzMTIgMjAuNTY5NiA0LjYwOTc4IDIwLjQ3MzZDNS42NTUxOSAyMy43MTY5IDguNjk0NjIgMjYuMTM1IDEyLjM1MzYgMjYuMTkyNkM5LjUyNzA4IDI4LjQxODcgNS45NDU1OCAyOS43MjM3IDIuMDM0OTcgMjkuNzIzN0MxLjM3Njc1IDI5LjcyMzcgMC43MTg1MjUgMjkuNjg1NCAwLjA2MDMwMjcgMjkuNjA4NkMzLjczODYgMzEuOTQ5OSA4LjExMzg0IDMzLjMxMjUgMTIuNzk4OCAzMy4zMTI1QzI4LjA1NDEgMzMuMzEyNSAzNi40MzY3IDIwLjc2MTUgMzYuNDM2NyA5Ljg4MDA3QzM2LjQzNjcgOS41MTU0NCAzNi40MzY3IDkuMTcgMzYuNDE3NCA4LjgwNTM3QzM4LjA0MzYgNy42NTM5IDM5LjQzNzUgNi4xOTUzNyA0MC41NjAzIDQuNTI1NzNaIiBmaWxsPSIjQThBOEE4Ii8+Cjwvc3ZnPgo=" alt="Twitter"/></a><a class="shareIcon" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://sbopsv.github.io/cloud-tech/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres&amp;title=Apache Spark on k8sからHologresへデータ連携方法&amp;summary=Apache Spark on k8sからHologresへデータ連携方法&amp;source=https://sbopsv.github.io/cloud-tech/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres" target="_blank" rel="nofollow noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzQiIHZpZXdCb3g9IjAgMCAzNCAzNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTI5LjY4NTMgMC42ODc1QzMwLjY0NjcgMC42ODc1IDMxLjU2ODcgMS4wNjk0MiAzMi4yNDg2IDEuNzQ5MjRDMzIuOTI4NCAyLjQyOTA2IDMzLjMxMDMgMy4zNTEwOSAzMy4zMTAzIDQuMzEyNVYyOS42ODc1QzMzLjMxMDMgMzAuNjQ4OSAzMi45Mjg0IDMxLjU3MDkgMzIuMjQ4NiAzMi4yNTA4QzMxLjU2ODcgMzIuOTMwNiAzMC42NDY3IDMzLjMxMjUgMjkuNjg1MyAzMy4zMTI1SDQuMzEwM0MzLjM0ODg5IDMzLjMxMjUgMi40MjY4NiAzMi45MzA2IDEuNzQ3MDQgMzIuMjUwOEMxLjA2NzIyIDMxLjU3MDkgMC42ODUzMDMgMzAuNjQ4OSAwLjY4NTMwMyAyOS42ODc1VjQuMzEyNUMwLjY4NTMwMyAzLjM1MTA5IDEuMDY3MjIgMi40MjkwNiAxLjc0NzA0IDEuNzQ5MjRDMi40MjY4NiAxLjA2OTQyIDMuMzQ4ODkgMC42ODc1IDQuMzEwMyAwLjY4NzVIMjkuNjg1M1pNMjguNzc5IDI4Ljc4MTJWMTkuMTc1QzI4Ljc3OSAxNy42MDc5IDI4LjE1NjUgMTYuMTA1IDI3LjA0ODQgMTQuOTk2OUMyNS45NDAzIDEzLjg4ODggMjQuNDM3NCAxMy4yNjYyIDIyLjg3MDMgMTMuMjY2MkMyMS4zMjk3IDEzLjI2NjIgMTkuNTM1MyAxNC4yMDg3IDE4LjY2NTMgMTUuNjIyNVYxMy42MTA2SDEzLjYwODRWMjguNzgxMkgxOC42NjUzVjE5Ljg0NTZDMTguNjY1MyAxOC40NSAxOS43ODkxIDE3LjMwODEgMjEuMTg0NyAxNy4zMDgxQzIxLjg1NzcgMTcuMzA4MSAyMi41MDMxIDE3LjU3NTUgMjIuOTc5IDE4LjA1MTNDMjMuNDU0OCAxOC41MjcyIDIzLjcyMjIgMTkuMTcyNiAyMy43MjIyIDE5Ljg0NTZWMjguNzgxMkgyOC43NzlaTTcuNzE3OCAxMC43NjVDOC41MjUzOSAxMC43NjUgOS4yOTk4OSAxMC40NDQyIDkuODcwOTQgOS44NzMxNEMxMC40NDIgOS4zMDIwOSAxMC43NjI4IDguNTI3NTggMTAuNzYyOCA3LjcyQzEwLjc2MjggNi4wMzQzNyA5LjQwMzQzIDQuNjU2ODcgNy43MTc4IDQuNjU2ODdDNi45MDU0MSA0LjY1Njg3IDYuMTI2MjkgNC45Nzk2IDUuNTUxODUgNS41NTQwNEM0Ljk3NzQgNi4xMjg0OSA0LjY1NDY4IDYuOTA3NjEgNC42NTQ2OCA3LjcyQzQuNjU0NjggOS40MDU2MiA2LjAzMjE4IDEwLjc2NSA3LjcxNzggMTAuNzY1Wk0xMC4yMzcyIDI4Ljc4MTJWMTMuNjEwNkg1LjIxNjU1VjI4Ljc4MTJIMTAuMjM3MloiIGZpbGw9IiNBOEE4QTgiLz4KPC9zdmc+Cg==" alt="Linkedin"/></a></div></div><style data-emotion="css sgjh1r">.css-sgjh1r{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding-top:14px;}.css-sgjh1r .helpfulWrapper{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-sgjh1r .helpfulWrapper .desc{padding-right:8px;padding-bottom:0;}.css-sgjh1r .helpfulWrapper .iconWrapper{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-sgjh1r .helpfulWrapper .iconWrapper .satisfied,.css-sgjh1r .helpfulWrapper .iconWrapper .dissatisfied{margin:0 8px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;cursor:pointer;position:relative;}.css-sgjh1r .helpfulWrapper .iconWrapper .satisfied:hover svg,.css-sgjh1r .helpfulWrapper .iconWrapper .dissatisfied:hover svg{fill:#0079BD;}.css-sgjh1r .helpfulWrapper .iconWrapper .satisfied svg,.css-sgjh1r .helpfulWrapper .iconWrapper .dissatisfied svg{fill:#74818A;}.css-sgjh1r .helpfulWrapper .iconWrapper .satisfied .toolTip,.css-sgjh1r .helpfulWrapper .iconWrapper .dissatisfied .toolTip{background-color:#000;border-radius:4px;padding:4px 10px;color:#fff;position:absolute;min-width:-webkit-max-content;min-width:-moz-max-content;min-width:max-content;top:-34px;left:50%;-webkit-transform:translateX(-50%);-moz-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);font-weight:300;font-size:14px;}.css-sgjh1r .helpfulWrapper .iconWrapper .active svg{fill:#0079BD;}@media (min-width: 768px) and (max-width: 1110px){.css-sgjh1r{display:block;}.css-sgjh1r .helpfulWrapper{padding-bottom:12px;}}@media(max-width: 767px){.css-sgjh1r{display:block;}.css-sgjh1r .helpfulWrapper{display:block;}.css-sgjh1r .helpfulWrapper .desc{padding-right:0;text-align:center;}.css-sgjh1r .helpfulWrapper .iconWrapper{-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:16px 0;}}</style><div class="css-sgjh1r ei7q9pp0"><div class="helpfulWrapper"><div class="desc">このページは参考になりましたか？</div><div class="iconWrapper"><div class="satisfied"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 11C16.3284 11 17 10.3284 17 9.5C17 8.67157 16.3284 8 15.5 8C14.6716 8 14 8.67157 14 9.5C14 10.3284 14.6716 11 15.5 11Z"></path><path d="M8.5 11C9.32843 11 10 10.3284 10 9.5C10 8.67157 9.32843 8 8.5 8C7.67157 8 7 8.67157 7 9.5C7 10.3284 7.67157 11 8.5 11Z"></path><path d="M15.5 11C16.3284 11 17 10.3284 17 9.5C17 8.67157 16.3284 8 15.5 8C14.6716 8 14 8.67157 14 9.5C14 10.3284 14.6716 11 15.5 11Z"></path><path d="M8.5 11C9.32843 11 10 10.3284 10 9.5C10 8.67157 9.32843 8 8.5 8C7.67157 8 7 8.67157 7 9.5C7 10.3284 7.67157 11 8.5 11Z"></path><path d="M11.99 2C6.47 2 2 6.48 2 12C2 17.52 6.47 22 11.99 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 11.99 2ZM12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20ZM12 17.5C14.33 17.5 16.32 16.05 17.12 14H15.45C14.76 15.19 13.48 16 12 16C10.52 16 9.25 15.19 8.55 14H6.88C7.68 16.05 9.67 17.5 12 17.5Z"></path></svg></div><div class="dissatisfied"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 11C16.3284 11 17 10.3284 17 9.5C17 8.67157 16.3284 8 15.5 8C14.6716 8 14 8.67157 14 9.5C14 10.3284 14.6716 11 15.5 11Z"></path><path d="M8.5 11C9.32843 11 10 10.3284 10 9.5C10 8.67157 9.32843 8 8.5 8C7.67157 8 7 8.67157 7 9.5C7 10.3284 7.67157 11 8.5 11Z"></path><path d="M11.99 2C6.47 2 2 6.48 2 12C2 17.52 6.47 22 11.99 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 11.99 2ZM12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20ZM12 14C9.67 14 7.68 15.45 6.88 17.5H8.55C9.24 16.31 10.52 15.5 12 15.5C13.48 15.5 14.75 16.31 15.45 17.5H17.12C16.32 15.45 14.33 14 12 14Z"></path></svg></div></div></div><div class="css-z4d6fw ei7q9pp2"><div class="editOnGithub"><a href="https://github.com/sbopsv/cloud-tech/tree/master/content/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres.md" class="gitBtn" target="_blank"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4yIiBiYXNlUHJvZmlsZT0idGlueSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiDQoJIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMjM1MCAyMzE0LjgiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBhdGggZD0iTTExNzUsMEM1MjUuOCwwLDAsNTI1LjgsMCwxMTc1YzAsNTUyLjIsMzc4LjksMTAxMC41LDg5MC4xLDExMzkuN2MtNS45LTE0LjctOC44LTM1LjMtOC44LTU1Ljh2LTE5OS44SDczNC40DQoJYy03OS4zLDAtMTUyLjgtMzUuMi0xODUuMS05OS45Yy0zOC4yLTcwLjUtNDQuMS0xNzkuMi0xNDEtMjQ2LjhjLTI5LjQtMjMuNS01LjktNDcsMjYuNC00NC4xYzYxLjcsMTcuNiwxMTEuNiw1OC44LDE1OC42LDEyMC40DQoJYzQ3LDYxLjcsNjcuNiw3Ni40LDE1NS43LDc2LjRjNDEuMSwwLDEwNS43LTIuOSwxNjQuNS0xMS44YzMyLjMtODIuMyw4OC4xLTE1NS43LDE1NS43LTE5MC45Yy0zOTMuNi00Ny01ODEuNi0yNDAuOS01ODEuNi01MDUuMw0KCWMwLTExNC42LDQ5LjktMjIzLjMsMTMyLjItMzE3LjNjLTI2LjQtOTEuMS02MS43LTI3OS4xLDExLjgtMzUyLjVjMTc2LjMsMCwyODIsMTE0LjYsMzA4LjQsMTQzLjljODguMS0yOS40LDE4NS4xLTQ3LDI4NC45LTQ3DQoJYzEwMi44LDAsMTk2LjgsMTcuNiwyODQuOSw0N2MyNi40LTI5LjQsMTMyLjItMTQzLjksMzA4LjQtMTQzLjljNzAuNSw3MC41LDM4LjIsMjYxLjQsOC44LDM1Mi41YzgyLjMsOTEuMSwxMjkuMywyMDIuNywxMjkuMywzMTcuMw0KCWMwLDI2NC40LTE4NS4xLDQ1OC4zLTU3NS43LDQ5OS40YzEwOC43LDU1LjgsMTg1LjEsMjE0LjQsMTg1LjEsMzMxLjlWMjI1NmMwLDguOC0yLjksMTcuNi0yLjksMjYuNA0KCUMyMDIxLDIxMjMuOCwyMzUwLDE2ODkuMSwyMzUwLDExNzVDMjM1MCw1MjUuOCwxODI0LjIsMCwxMTc1LDBMMTE3NSwweiIvPg0KPC9zdmc+DQo=" alt="Github logo"/> Edit on GitHub<div class="arrow"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.63611 11.9698C7.34322 12.2627 7.34322 12.7375 7.63611 13.0304C7.92901 13.3233 8.40388 13.3233 8.69677 13.0304L13.1968 8.53038C13.4897 8.23748 13.4897 7.76261 13.1968 7.46971L8.69677 2.96967C8.40388 2.67678 7.92901 2.67678 7.63611 2.96967C7.34322 3.26256 7.34322 3.73744 7.63611 4.03033L10.8558 7.25L2.99982 7.25C2.5856 7.25 2.24982 7.58579 2.24982 8C2.24982 8.41422 2.5856 8.75 2.99982 8.75L10.8559 8.75L7.63611 11.9698Z" fill="#1B2738"></path></svg></div></a></div></div></div><div class="addPaddTopBottom"><div class="nextPreviousWrapper"><a class="previousBtn" href="/cloud-tech/usecase-Hologres/HOLOGRES_008_s3-hologres"><div class="leftArrow"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" class="_13gjrqj"><g><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></g></svg></div><div class="preRightWrapper"><div class="nextPreviousTitle"><span>AWS S3からHologres連携</span></div></div></a><a class="nextBtn" href="/cloud-tech/usecase-Hologres/HOLOGRES_010_flink-on-k8s-hologres"><div class="nextRightWrapper"><div class="nextPreviousTitle"><span>Flink on k8sからHologres連携</span></div></div><div class="rightArrow"><svg preserveAspectRatio="xMidYMid meet" height="1em" width="1em" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" class="_13gjrqj"><g><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></g></svg></div></a></div></div></div></main><style data-emotion="css 1p3jlfo">.css-1p3jlfo{width:256px;border-left:1px solid #D5DEE6;min-height:calc(100vh - 72px);height:calc(100vh - 72px);display:grid;position:fixed;top:72px;right:0px;-webkit-transition:all 0.3s ease-in-out 0s;transition:all 0.3s ease-in-out 0s;}@media(max-width: 1024px){.css-1p3jlfo{display:none;}}</style><div class="css-1p3jlfo et716sf2"><style data-emotion="css ohzssd">.css-ohzssd .languageWrapper{position:relative;padding:16px 24px;z-index:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-ohzssd .languageWrapper .githubStars{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-ohzssd .languageWrapper .githubStars span{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-ohzssd .languageWrapper .languageDropDownWrapper{display:none;position:absolute;top:56px;background-color:#FFFFFF;box-shadow:0px 2px 6px rgba(0, 0, 0, 0.2);border-radius:8px;padding:12px 16px;}.css-ohzssd .languageWrapper .languageDropDownWrapper ul li{list-style-type:none;}.css-ohzssd .languageWrapper .languageDropDownWrapper ul li a{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:8px 8px;font-family:"IBM Plex Sans";font-weight:300;font-size:12px;color:#616D75;border-radius:4px;}.css-ohzssd .languageWrapper .languageDropDownWrapper ul li a:hover{background-color:#EBF1F7;}.css-ohzssd .languageWrapper .languageDropDownWrapper ul li a img{margin-right:8px;}.css-ohzssd .languageWrapper .showList{display:block;}@media(max-width: 1024px){.css-ohzssd .languageWrapper{border-top:1px solid rgb(214, 222, 230);padding:16px 24px;background-color:rgb(244, 248, 251);}}</style><div class="css-ohzssd et716sf1"><div class="languageWrapper"><div class="githubStars"><span><a href="https://github.com/sbopsv/cloud-tech" data-size="large" data-show-count="true" aria-label="Star @SoftBank on GitHub">Star</a></span></div></div></div><style data-emotion="css q2xf8j">.css-q2xf8j{width:100%;background-color:#fff;overflow:auto;position:fixed;display:grid;padding-left:0px;position:-webkit-sticky;position:-moz-sticky;position:-webkit-sticky;position:sticky;top:0;}@media only screen and (max-width: 50rem){.css-q2xf8j{width:100%;position:relative;}}</style><aside class="css-q2xf8j et2uw8a1"><ul class="rightSideBarUL"><li class="rightSideTitle">CONTENTS</li><style data-emotion="css saglwj">.css-saglwj{list-style:none;}.css-saglwj a{color:#5c6975;-webkit-text-decoration:none;text-decoration:none;font-weight:400;padding:0.45rem 0 0.45rem 3rem;display:block;position:relative;}.css-saglwj a:hover{color:#005C8F;}.css-saglwj a svg{float:right;margin-right:1rem;}</style><li class="css-saglwj et2uw8a0"><a href="##" to="##"></a></li><li class="css-saglwj et2uw8a0"><a href="#hologresとは" to="#hologresとは">Hologresとは</a></li><li class="css-saglwj et2uw8a0"><a href="#apachesparkとは" to="#apachesparkとは">Apache Sparkとは</a></li><li class="css-saglwj et2uw8a0"><a href="#kubernetes（k8s）とは" to="#kubernetes（k8s）とは">Kubernetes（k8s）とは</a></li><li class="css-saglwj et2uw8a0"><a href="#azurekubernetes上でapachesparkを使ってhologresでデータ処理をする" to="#azurekubernetes上でapachesparkを使ってhologresでデータ処理をする">Azure Kubernetes上でApache Sparkを使ってHologresでデータ処理をする</a></li><li class="css-saglwj et2uw8a0"><a href="#このチュートリアルについて" to="#このチュートリアルについて">このチュートリアルについて</a></li><li class="css-saglwj et2uw8a0"><a href="#hologresテーブルの準備" to="#hologresテーブルの準備">Hologresテーブルの準備</a></li><li class="css-saglwj et2uw8a0"><a href="#特定データファイルおよびjarファイルを含むapachesparkのimageファイルのbuild" to="#特定データファイルおよびjarファイルを含むapachesparkのimageファイルのbuild">特定データファイルおよびjarファイルを含むApache SparkのImageファイルのbuild</a></li><li class="css-saglwj et2uw8a0"><a href="#aks(azurekubernetesservice)clusterの準備" to="#aks(azurekubernetesservice)clusterの準備">AKS(Azure Kubernetes Service) clusterの準備</a></li><li class="css-saglwj et2uw8a0"><a href="#pysparkでスパークジョブの準備" to="#pysparkでスパークジョブの準備">PySparkでスパークジョブの準備</a></li><li class="css-saglwj et2uw8a0"><a href="#submitsparkjob" to="#submitsparkjob">Submit spark job</a></li><li class="css-saglwj et2uw8a0"><a href="#データ転送のためにalibabacloudlogserviceのリソース準備" to="#データ転送のためにalibabacloudlogserviceのリソース準備">データ転送のためにAlibaba Cloud Log Serviceのリソース準備</a></li><li class="css-saglwj et2uw8a0"><a href="#sparkstreamingjobの実行" to="#sparkstreamingjobの実行">Spark streaming jobの実行</a></li><li class="css-saglwj et2uw8a0"><a href="#最後に" to="#最後に">最後に</a></li></ul></aside></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/usecase-Hologres/HOLOGRES_009_spark-on-k8s-hologres";window.___webpackCompilationHash="bdf5df649caec116dd79";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-d7dfc556f677f92c0fff.js"],"app":["/app-32a237daea924fa1527a.js"],"component---src-templates-docs-js":[]};/*]]>*/</script><script src="/cloud-tech/polyfill-d7dfc556f677f92c0fff.js" nomodule=""></script><script src="/cloud-tech/app-32a237daea924fa1527a.js" async=""></script><script src="/cloud-tech/commons-c34b975b1ab0a98aa302.js" async=""></script><script src="/cloud-tech/framework-3a4afe8555327377c75b.js" async=""></script><script src="/cloud-tech/webpack-runtime-08625babbb4b9af8a274.js" async=""></script><div id="react-portal-wrapper"></div></body></html>